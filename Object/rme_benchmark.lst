ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 1


   1              		.cpu cortex-a9
   2              		.arch armv7-a
   3              		.fpu neon-fp16
   4              		.arch_extension mp
   5              		.arch_extension sec
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 6
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"rme_benchmark.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "Source/rme_benchmark.c"
  20              		.global	RME_Stack
  21              		.section	.bss.RME_Stack,"aw",%nobits
  22              		.align	2
  25              	RME_Stack:
  26 0000 00000000 		.space	8192
  26      00000000 
  26      00000000 
  26      00000000 
  26      00000000 
  27              		.global	Time
  28              		.section	.bss.Time,"aw",%nobits
  29              		.align	2
  32              	Time:
  33 0000 00000000 		.space	20000
  33      00000000 
  33      00000000 
  33      00000000 
  33      00000000 
  34              		.global	RME_Bench_Buf
  35              		.section	.bss.RME_Bench_Buf,"aw",%nobits
  36              		.align	2
  39              	RME_Bench_Buf:
  40 0000 00000000 		.space	1024
  40      00000000 
  40      00000000 
  40      00000000 
  40      00000000 
  41              		.section	.text.__USR_Putchar,"ax",%progbits
  42              		.align	2
  43              		.global	__USR_Putchar
  44              		.syntax unified
  45              		.arm
  47              	__USR_Putchar:
  48              	.LFB0:
  49              		.file 2 "Include/benchmark.h"
   1:Include/benchmark.h **** 
   2:Include/benchmark.h **** #include"rme.h"
   3:Include/benchmark.h **** /* Word size */
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 2


   4:Include/benchmark.h **** #define RME_WORD_BIT                                RME_POW2(RME_WORD_ORDER)
   5:Include/benchmark.h **** #define RME_WORD_BYTE                               (RME_WORD_BIT>>3)
   6:Include/benchmark.h **** #define RME_WORD_BIT_O1                             (RME_WORD_BYTE)
   7:Include/benchmark.h **** #define RME_WORD_BIT_O2                             (RME_WORD_BYTE*2U)
   8:Include/benchmark.h **** #define RME_WORD_BIT_O3                             (RME_WORD_BYTE*3U)
   9:Include/benchmark.h **** #define RME_WORD_BIT_O4                             (RME_WORD_BYTE*4U)
  10:Include/benchmark.h **** #define RME_WORD_BIT_O5                             (RME_WORD_BYTE*5U)
  11:Include/benchmark.h **** #define RME_WORD_BIT_O6                             (RME_WORD_BYTE*6U)
  12:Include/benchmark.h **** #define RME_WORD_BIT_O7                             (RME_WORD_BYTE*7U)
  13:Include/benchmark.h **** #define RME_WORD_BIT_Q1                             RME_WORD_BIT_O2
  14:Include/benchmark.h **** #define RME_WORD_BIT_Q2                             RME_WORD_BIT_O4
  15:Include/benchmark.h **** #define RME_WORD_BIT_Q3                             RME_WORD_BIT_O6
  16:Include/benchmark.h **** #define RME_WORD_BIT_D1                             RME_WORD_BIT_Q2
  17:Include/benchmark.h **** /* Thread creation */
  18:Include/benchmark.h **** #define RME_THD_SVC(ATTR,IS_HYP,SVC)                (RME_FIELD(ATTR,7U)|RME_FIELD(IS_HYP,6U)|(SVC))
  19:Include/benchmark.h **** /* UART peripheral address */
  20:Include/benchmark.h **** #define RME_A7A_UART_CONTROL      					(*((volatile unsigned int*)(0xE0001000)))
  21:Include/benchmark.h **** #define RME_A7A_UART_MODE         					(*((volatile unsigned int*)(0xE0001004)))
  22:Include/benchmark.h **** #define RME_A7A_UART_BRGEN        					(*((volatile unsigned int*)(0xE0001018)))
  23:Include/benchmark.h **** #define RME_A7A_UART_STATUS       					(*((volatile unsigned int*)(0xE000102C)))
  24:Include/benchmark.h **** #define RME_A7A_UART_FIFO         					(*((volatile unsigned int*)(0xE0001030)))
  25:Include/benchmark.h **** #define RME_A7A_UART_BRDIV        					(*((volatile unsigned int*)(0xE0001034)))
  26:Include/benchmark.h **** #define RME_A7A_UART_STATUS_TXE   					(1U<<3)
  27:Include/benchmark.h **** //#define RME_DBG_S(STR)                              RME_Str_Print((const signed char*)(STR))
  28:Include/benchmark.h **** /*NULL*/
  29:Include/benchmark.h **** #define RME_NULL 									0
  30:Include/benchmark.h **** 
  31:Include/benchmark.h **** #define RME_A7A_PUTCHAR(CHAR) \
  32:Include/benchmark.h **** do \
  33:Include/benchmark.h **** { \
  34:Include/benchmark.h ****     while((RME_A7A_UART_STATUS&RME_A7A_UART_STATUS_TXE)==0); \
  35:Include/benchmark.h **** 	RME_A7A_UART_FIFO=(CHAR); \
  36:Include/benchmark.h **** } \
  37:Include/benchmark.h **** while(0)
  38:Include/benchmark.h **** 
  39:Include/benchmark.h **** 
  40:Include/benchmark.h **** /* Define ********************************************************************/
  41:Include/benchmark.h **** /* Types */
  42:Include/benchmark.h **** typedef signed int                          s32;
  43:Include/benchmark.h **** typedef signed short                        s16;
  44:Include/benchmark.h **** typedef signed char                         s8;
  45:Include/benchmark.h **** typedef unsigned int                        u32;
  46:Include/benchmark.h **** typedef unsigned short                      u16;
  47:Include/benchmark.h **** typedef unsigned char                       u8;
  48:Include/benchmark.h **** typedef s32                                 tid_t;
  49:Include/benchmark.h **** typedef u32                       			ptr_t;
  50:Include/benchmark.h **** typedef s32                       			cnt_t;
  51:Include/benchmark.h **** typedef s32 								cid_t;
  52:Include/benchmark.h **** typedef s32                        			ret_t;
  53:Include/benchmark.h **** 
  54:Include/benchmark.h **** #define BENCHMARK_STACK_SIZE 4096
  55:Include/benchmark.h **** /* System service stub */
  56:Include/benchmark.h **** //#define RME_CAP_OP(OP,CAPID,ARG1,ARG2,ARG3) RME_Svc(((OP)<<(sizeof(ptr_t)*4)|(CAPID)),ARG1,ARG2,A
  57:Include/benchmark.h **** #define RME_PARAM_D_MASK                    (((ptr_t)(-1))>>(sizeof(ptr_t)*4))
  58:Include/benchmark.h **** #define RME_PARAM_Q_MASK                    (((ptr_t)(-1))>>(sizeof(ptr_t)*6))
  59:Include/benchmark.h **** #define RME_PARAM_O_MASK                    (((ptr_t)(-1))>>(sizeof(ptr_t)*7))
  60:Include/benchmark.h **** /* The parameter passing - not to be confused with kernel macros. These macros just place the param
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 3


  61:Include/benchmark.h **** #define RME_PARAM_D1(X)                     (((X)&RME_PARAM_D_MASK)<<(sizeof(ptr_t)*4))
  62:Include/benchmark.h **** #define RME_PARAM_D0(X)                     ((X)&RME_PARAM_D_MASK)
  63:Include/benchmark.h **** 
  64:Include/benchmark.h **** #define RME_PARAM_Q3(X)                     (((X)&RME_PARAM_Q_MASK)<<(sizeof(ptr_t)*6))
  65:Include/benchmark.h **** #define RME_PARAM_Q2(X)                     (((X)&RME_PARAM_Q_MASK)<<(sizeof(ptr_t)*4))
  66:Include/benchmark.h **** #define RME_PARAM_Q1(X)                     (((X)&RME_PARAM_Q_MASK)<<(sizeof(ptr_t)*2))
  67:Include/benchmark.h **** #define RME_PARAM_Q0(X)                     ((X)&RME_PARAM_Q_MASK)
  68:Include/benchmark.h **** 
  69:Include/benchmark.h **** #define RME_PARAM_O7(X)                     (((X)&RME_PARAM_O_MASK)<<(sizeof(ptr_t)*7))
  70:Include/benchmark.h **** #define RME_PARAM_O6(X)                     (((X)&RME_PARAM_O_MASK)<<(sizeof(ptr_t)*6))
  71:Include/benchmark.h **** #define RME_PARAM_O5(X)                     (((X)&RME_PARAM_O_MASK)<<(sizeof(ptr_t)*5))
  72:Include/benchmark.h **** #define RME_PARAM_O4(X)                     (((X)&RME_PARAM_O_MASK)<<(sizeof(ptr_t)*4))
  73:Include/benchmark.h **** #define RME_PARAM_O3(X)                     (((X)&RME_PARAM_O_MASK)<<(sizeof(ptr_t)*3))
  74:Include/benchmark.h **** #define RME_PARAM_O2(X)                     (((X)&RME_PARAM_O_MASK)<<(sizeof(ptr_t)*2))
  75:Include/benchmark.h **** #define RME_PARAM_O1(X)                     (((X)&RME_PARAM_O_MASK)<<(sizeof(ptr_t)*1))
  76:Include/benchmark.h **** #define RME_PARAM_O0(X)                     ((X)&RME_PARAM_O_MASK)
  77:Include/benchmark.h **** 
  78:Include/benchmark.h **** 
  79:Include/benchmark.h **** /* Bit mask */
  80:Include/benchmark.h **** #define RME_MASK_FULL                               (~((ptr_t)0U))
  81:Include/benchmark.h **** #define RME_MASK_WORD                               (~(RME_MASK_FULL<<RME_WORD_ORDER))
  82:Include/benchmark.h **** #define RME_MASK_WORD_O                             RME_MASK_END(RME_WORD_BIT_O1-1U)
  83:Include/benchmark.h **** #define RME_MASK_WORD_Q                             RME_MASK_END(RME_WORD_BIT_Q1-1U)
  84:Include/benchmark.h **** #define RME_MASK_WORD_D                             RME_MASK_END(RME_WORD_BIT_D1-1U)
  85:Include/benchmark.h **** /* Init thread infinite time marker */
  86:Include/benchmark.h **** #define RME_THD_INIT_TIME                           (RME_MASK_FULL>>1)
  87:Include/benchmark.h **** /* Other thread infinite time marker */
  88:Include/benchmark.h **** #define RME_THD_INF_TIME                            (RME_THD_INIT_TIME-1U)
  89:Include/benchmark.h **** 
  90:Include/benchmark.h **** /* Initial boot capabilities - This should be in accordnace with the kernel settings */
  91:Include/benchmark.h **** /* The capability table of the init process */
  92:Include/benchmark.h **** #define RME_BOOT_INIT_CPT                 		0
  93:Include/benchmark.h **** /* The top-level page table of the init process - always 4GB full range split into 8 pages */
  94:Include/benchmark.h **** #define RME_BOOT_INIT_PGT                 		1
  95:Include/benchmark.h **** /* The init process */
  96:Include/benchmark.h **** #define RME_BOOT_INIT_PRC                 		2
  97:Include/benchmark.h **** /* The init thread */
  98:Include/benchmark.h **** #define RME_BOOT_INIT_THD                 		3
  99:Include/benchmark.h **** /* The initial kernel function capability */
 100:Include/benchmark.h **** #define RME_BOOT_INIT_KFN          				4
 101:Include/benchmark.h **** /* The initial kernel memory capability */
 102:Include/benchmark.h **** #define RME_BOOT_INIT_KOM         				5
 103:Include/benchmark.h **** /* The initial timer endpoint */
 104:Include/benchmark.h **** #define RME_BOOT_INIT_TIMER      				6
 105:Include/benchmark.h **** /* The test objects */
 106:Include/benchmark.h **** #define RME_BOOT_BENCH_THD       				8
 107:Include/benchmark.h **** #define RME_BOOT_BENCH_PGT_TOP   				9
 108:Include/benchmark.h **** #define RME_BOOT_BENCH_PGT_SRAM  				10
 109:Include/benchmark.h **** /* The top-level page table of the init process's SRAM */
 110:Include/benchmark.h **** #define RME_BOOT_INIT_PGT_SRAM    				11
 111:Include/benchmark.h **** 
 112:Include/benchmark.h **** /* Power of 2 */
 113:Include/benchmark.h **** #define RME_FIELD(VAL,POW)                      (((ptr_t)(VAL))<<(POW))
 114:Include/benchmark.h **** #define RME_POW2(POW)                           RME_FIELD(1U,POW)
 115:Include/benchmark.h **** /* The order of bits in one CPU machine word */
 116:Include/benchmark.h **** #define RME_WORD_ORDER            				(5U)
 117:Include/benchmark.h **** /* Word size */
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 4


 118:Include/benchmark.h **** #define RME_WORD_BIT                            RME_POW2(RME_WORD_ORDER)
 119:Include/benchmark.h **** /* Need to export the memory frontier! */
 120:Include/benchmark.h **** /* Need to export the flags as well ! */
 121:Include/benchmark.h **** /* Export the errno too */
 122:Include/benchmark.h **** #define RME_BOOT_BENCH_KOM_FRONTIER 			0x00009000
 123:Include/benchmark.h **** /* The kernel-accessible virtual memory address,for this thread's register sets */
 124:Include/benchmark.h **** #define RME_BOOT_HYPER_KOM_VADDR                0x00000000
 125:Include/benchmark.h **** //0x10005000
 126:Include/benchmark.h **** /* The stack safe size */
 127:Include/benchmark.h **** #define RME_STACK_SAFE_SIZE 					16
 128:Include/benchmark.h **** /* Doesn't want to receive the scheduler signal for the thread */
 129:Include/benchmark.h **** #define RME_CID_NULL   							0x8000
 130:Include/benchmark.h **** /* The maximum priority allowed for this thread. Once set, this cannot be changed. */
 131:Include/benchmark.h **** #define RME_THD_PRIO_MAX                        31
 132:Include/benchmark.h **** /*The thread ID*/
 133:Include/benchmark.h **** #define RME_TID_1                               1
 134:Include/benchmark.h **** #define RME_TID_2                               2
 135:Include/benchmark.h **** #define RME_TID_3                               3
 136:Include/benchmark.h **** #define RME_TID_4                               4
 137:Include/benchmark.h **** #define RME_TID_6                               6
 138:Include/benchmark.h **** 
 139:Include/benchmark.h **** /* End Define ****************************************************************/
 140:Include/benchmark.h **** 
 141:Include/benchmark.h **** 
 142:Include/benchmark.h **** 
 143:Include/benchmark.h **** /* Private Variables *********************************************************/
 144:Include/benchmark.h **** /* The stack of the threads - enough for 4 threads */
 145:Include/benchmark.h **** ptr_t RME_Stack[2048];
 146:Include/benchmark.h **** u16 Time[10000];
 147:Include/benchmark.h **** s8 RME_Bench_Buf[1024];
 148:Include/benchmark.h **** /* End Private Variables *****************************************************/
 149:Include/benchmark.h **** 
 150:Include/benchmark.h **** /* Function Prototypes *******************************************************/
 151:Include/benchmark.h **** extern ret_t RME_Svc(ptr_t Svc_Capid,ptr_t Param1, ptr_t Param2, ptr_t Param3);
 152:Include/benchmark.h **** /* System service stub */
 153:Include/benchmark.h **** #define RME_SVC(SVC,CID,ARG1,ARG2,ARG3)             RME_Svc(RME_FIELD(SVC,RME_WORD_BIT_D1)|((ptr_t)
 154:Include/benchmark.h **** extern cnt_t RME_Sprint_Uint(s8* Buffer,u32 Arg_Int);
 155:Include/benchmark.h **** extern void RME_Thd_Stub(void);
 156:Include/benchmark.h **** extern void RME_Inv_Stub(void);
 157:Include/benchmark.h **** ptr_t _RME_Stack_Init(ptr_t Stack, ptr_t Stub, ptr_t Param1, ptr_t Param2, ptr_t Param3, ptr_t Para
 158:Include/benchmark.h **** void RME_Benchmark(void);
 159:Include/benchmark.h **** void RME_Same_Prc_Thd_Switch_Test_Thd(ptr_t Param1);
 160:Include/benchmark.h **** void RME_Same_Prc_Thd_Switch_Test(void);
 161:Include/benchmark.h **** /* End Function Prototypes ***************************************************/
 162:Include/benchmark.h **** 
 163:Include/benchmark.h **** /* Function:__USR_Putchar *****************************************************
 164:Include/benchmark.h **** Description : Output a character to console. In Cortex-M, under most circumstances,
 165:Include/benchmark.h ****               we should use the ITM for such outputs.
 166:Include/benchmark.h **** Input       : char Char - The character to print.
 167:Include/benchmark.h **** Output      : None.
 168:Include/benchmark.h **** Return      : rme_ptr_t - Always 0.
 169:Include/benchmark.h **** ******************************************************************************/
 170:Include/benchmark.h **** ptr_t __USR_Putchar(char Char)
 171:Include/benchmark.h **** {
  50              		.loc 2 171 1
  51              		.cfi_startproc
  52              		@ args = 0, pretend = 0, frame = 8
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 5


  53              		@ frame_needed = 1, uses_anonymous_args = 0
  54              		@ link register save eliminated.
  55 0000 04B02DE5 		str	fp, [sp, #-4]!
  56              		.cfi_def_cfa_offset 4
  57              		.cfi_offset 11, -4
  58 0004 00B08DE2 		add	fp, sp, #0
  59              		.cfi_def_cfa_register 11
  60 0008 0CD04DE2 		sub	sp, sp, #12
  61 000c 0030A0E1 		mov	r3, r0
  62 0010 05304BE5 		strb	r3, [fp, #-5]
  63              	.L2:
 172:Include/benchmark.h ****     RME_A7A_PUTCHAR(Char);
  64              		.loc 2 172 5 discriminator 1
  65 0014 2C3001E3 		movw	r3, #4140
  66 0018 00304EE3 		movt	r3, 57344
  67 001c 003093E5 		ldr	r3, [r3]
  68 0020 083003E2 		and	r3, r3, #8
  69 0024 000053E3 		cmp	r3, #0
  70 0028 F9FFFF0A 		beq	.L2
  71              		.loc 2 172 5 is_stmt 0 discriminator 2
  72 002c 303001E3 		movw	r3, #4144
  73 0030 00304EE3 		movt	r3, 57344
  74 0034 D5205BE1 		ldrsb	r2, [fp, #-5]
  75 0038 002083E5 		str	r2, [r3]
 173:Include/benchmark.h ****     return 0;
  76              		.loc 2 173 12 is_stmt 1
  77 003c 0030A0E3 		mov	r3, #0
 174:Include/benchmark.h **** }
  78              		.loc 2 174 1
  79 0040 0300A0E1 		mov	r0, r3
  80 0044 00D08BE2 		add	sp, fp, #0
  81              		.cfi_def_cfa_register 13
  82              		@ sp needed
  83 0048 04B09DE4 		ldr	fp, [sp], #4
  84              		.cfi_restore 11
  85              		.cfi_def_cfa_offset 0
  86 004c 1EFF2FE1 		bx	lr
  87              		.cfi_endproc
  88              	.LFE0:
  90              		.section	.text.USR_DBG_I,"ax",%progbits
  91              		.align	2
  92              		.global	USR_DBG_I
  93              		.syntax unified
  94              		.arm
  96              	USR_DBG_I:
  97              	.LFB1:
 175:Include/benchmark.h **** /* End Function __USR_Putchar ***************************************************/
 176:Include/benchmark.h **** 
 177:Include/benchmark.h **** 
 178:Include/benchmark.h **** /* Function:USR_DBG_I *****************************************************
 179:Include/benchmark.h **** Description : Print a signed integer on the debugging console. This integer is
 180:Include/benchmark.h ****               printed as decimal with sign.
 181:Include/benchmark.h **** Input       : rme_cnt_t Int - The integer to print.
 182:Include/benchmark.h **** Output      : None.
 183:Include/benchmark.h **** Return      : rme_cnt_t - The length of the string printed.
 184:Include/benchmark.h **** ******************************************************************************/
 185:Include/benchmark.h **** cnt_t USR_DBG_I(cnt_t Int)
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 6


 186:Include/benchmark.h **** {
  98              		.loc 2 186 1
  99              		.cfi_startproc
 100              		@ args = 0, pretend = 0, frame = 32
 101              		@ frame_needed = 1, uses_anonymous_args = 0
 102 0000 00482DE9 		push	{fp, lr}
 103              		.cfi_def_cfa_offset 8
 104              		.cfi_offset 11, -8
 105              		.cfi_offset 14, -4
 106 0004 04B08DE2 		add	fp, sp, #4
 107              		.cfi_def_cfa 11, 4
 108 0008 20D04DE2 		sub	sp, sp, #32
 109 000c 20000BE5 		str	r0, [fp, #-32]
 187:Include/benchmark.h ****     cnt_t Num;
 188:Include/benchmark.h ****     cnt_t Abs;
 189:Include/benchmark.h ****     cnt_t Iter;
 190:Include/benchmark.h ****     cnt_t Count;
 191:Include/benchmark.h ****     cnt_t Div;
 192:Include/benchmark.h **** 
 193:Include/benchmark.h ****     /* Exit on zero */
 194:Include/benchmark.h ****     if(Int==0)
 110              		.loc 2 194 7
 111 0010 20301BE5 		ldr	r3, [fp, #-32]
 112 0014 000053E3 		cmp	r3, #0
 113 0018 0300001A 		bne	.L5
 195:Include/benchmark.h ****     {
 196:Include/benchmark.h **** 
 197:Include/benchmark.h **** 
 198:Include/benchmark.h ****         __USR_Putchar('0');
 114              		.loc 2 198 9
 115 001c 3000A0E3 		mov	r0, #48
 116 0020 FEFFFFEB 		bl	__USR_Putchar
 199:Include/benchmark.h ****         return 1;
 117              		.loc 2 199 16
 118 0024 0130A0E3 		mov	r3, #1
 119 0028 500000EA 		b	.L6
 120              	.L5:
 200:Include/benchmark.h ****     }
 201:Include/benchmark.h ****     else
 202:Include/benchmark.h ****     {
 203:Include/benchmark.h **** 
 204:Include/benchmark.h ****         /* No action required */
 205:Include/benchmark.h ****     }
 206:Include/benchmark.h **** 
 207:Include/benchmark.h **** 
 208:Include/benchmark.h ****     /* Correct all negatives into positives */
 209:Include/benchmark.h ****     if(Int<0)
 121              		.loc 2 209 7
 122 002c 20301BE5 		ldr	r3, [fp, #-32]
 123 0030 000053E3 		cmp	r3, #0
 124 0034 070000AA 		bge	.L7
 210:Include/benchmark.h ****     {
 211:Include/benchmark.h **** 
 212:Include/benchmark.h **** 
 213:Include/benchmark.h ****         __USR_Putchar('-');
 125              		.loc 2 213 9
 126 0038 2D00A0E3 		mov	r0, #45
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 7


 127 003c FEFFFFEB 		bl	__USR_Putchar
 214:Include/benchmark.h ****         Abs=-Int;
 128              		.loc 2 214 12
 129 0040 20301BE5 		ldr	r3, [fp, #-32]
 130 0044 003063E2 		rsb	r3, r3, #0
 131 0048 0C300BE5 		str	r3, [fp, #-12]
 215:Include/benchmark.h ****         Num=1;
 132              		.loc 2 215 12
 133 004c 0130A0E3 		mov	r3, #1
 134 0050 08300BE5 		str	r3, [fp, #-8]
 135 0054 030000EA 		b	.L8
 136              	.L7:
 216:Include/benchmark.h ****     }
 217:Include/benchmark.h ****     else
 218:Include/benchmark.h ****     {
 219:Include/benchmark.h **** 
 220:Include/benchmark.h **** 
 221:Include/benchmark.h ****         Abs=Int;
 137              		.loc 2 221 12
 138 0058 20301BE5 		ldr	r3, [fp, #-32]
 139 005c 0C300BE5 		str	r3, [fp, #-12]
 222:Include/benchmark.h ****         Num=0;
 140              		.loc 2 222 12
 141 0060 0030A0E3 		mov	r3, #0
 142 0064 08300BE5 		str	r3, [fp, #-8]
 143              	.L8:
 223:Include/benchmark.h ****     }
 224:Include/benchmark.h **** 
 225:Include/benchmark.h ****     /* How many digits are there? */
 226:Include/benchmark.h ****     Count=0;
 144              		.loc 2 226 10
 145 0068 0030A0E3 		mov	r3, #0
 146 006c 14300BE5 		str	r3, [fp, #-20]
 227:Include/benchmark.h ****     Div=1;
 147              		.loc 2 227 8
 148 0070 0130A0E3 		mov	r3, #1
 149 0074 18300BE5 		str	r3, [fp, #-24]
 228:Include/benchmark.h ****     Iter=Abs;
 150              		.loc 2 228 9
 151 0078 0C301BE5 		ldr	r3, [fp, #-12]
 152 007c 10300BE5 		str	r3, [fp, #-16]
 153              	.L12:
 229:Include/benchmark.h ****     while(1U)
 230:Include/benchmark.h ****     {
 231:Include/benchmark.h ****         Iter/=10;
 154              		.loc 2 231 13
 155 0080 10201BE5 		ldr	r2, [fp, #-16]
 156 0084 673606E3 		movw	r3, #26215
 157 0088 663646E3 		movt	r3, 26214
 158 008c 9312C3E0 		smull	r1, r3, r3, r2
 159 0090 4311A0E1 		asr	r1, r3, #2
 160 0094 C23FA0E1 		asr	r3, r2, #31
 161 0098 033041E0 		sub	r3, r1, r3
 162 009c 10300BE5 		str	r3, [fp, #-16]
 232:Include/benchmark.h ****         Count++;
 163              		.loc 2 232 14
 164 00a0 14301BE5 		ldr	r3, [fp, #-20]
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 8


 165 00a4 013083E2 		add	r3, r3, #1
 166 00a8 14300BE5 		str	r3, [fp, #-20]
 233:Include/benchmark.h ****         if(Iter!=0)
 167              		.loc 2 233 11
 168 00ac 10301BE5 		ldr	r3, [fp, #-16]
 169 00b0 000053E3 		cmp	r3, #0
 170 00b4 0600000A 		beq	.L15
 234:Include/benchmark.h ****         {
 235:Include/benchmark.h **** 
 236:Include/benchmark.h **** 
 237:Include/benchmark.h ****             Div*=10;
 171              		.loc 2 237 16
 172 00b8 18201BE5 		ldr	r2, [fp, #-24]
 173 00bc 0230A0E1 		mov	r3, r2
 174 00c0 0331A0E1 		lsl	r3, r3, #2
 175 00c4 023083E0 		add	r3, r3, r2
 176 00c8 8330A0E1 		lsl	r3, r3, #1
 177 00cc 18300BE5 		str	r3, [fp, #-24]
 231:Include/benchmark.h ****         Count++;
 178              		.loc 2 231 13
 179 00d0 EAFFFFEA 		b	.L12
 180              	.L15:
 238:Include/benchmark.h ****         }
 239:Include/benchmark.h ****         else
 240:Include/benchmark.h ****         {
 241:Include/benchmark.h **** 
 242:Include/benchmark.h **** 
 243:Include/benchmark.h ****             break;
 181              		.loc 2 243 13
 182 00d4 00F020E3 		nop
 244:Include/benchmark.h ****         }
 245:Include/benchmark.h ****     }
 246:Include/benchmark.h ****     Num+=Count;
 183              		.loc 2 246 8
 184 00d8 08201BE5 		ldr	r2, [fp, #-8]
 185 00dc 14301BE5 		ldr	r3, [fp, #-20]
 186 00e0 033082E0 		add	r3, r2, r3
 187 00e4 08300BE5 		str	r3, [fp, #-8]
 247:Include/benchmark.h **** 
 248:Include/benchmark.h ****     /* Print the integer */
 249:Include/benchmark.h ****     Iter=Abs;
 188              		.loc 2 249 9
 189 00e8 0C301BE5 		ldr	r3, [fp, #-12]
 190 00ec 10300BE5 		str	r3, [fp, #-16]
 250:Include/benchmark.h **** 
 251:Include/benchmark.h ****     while(Count>0)
 191              		.loc 2 251 10
 192 00f0 1A0000EA 		b	.L13
 193              	.L14:
 252:Include/benchmark.h ****     {
 253:Include/benchmark.h ****         Count--;
 194              		.loc 2 253 14
 195 00f4 14301BE5 		ldr	r3, [fp, #-20]
 196 00f8 013043E2 		sub	r3, r3, #1
 197 00fc 14300BE5 		str	r3, [fp, #-20]
 254:Include/benchmark.h ****         __USR_Putchar((s8)(Iter/Div)+'0');
 198              		.loc 2 254 32
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 9


 199 0100 18101BE5 		ldr	r1, [fp, #-24]
 200 0104 10001BE5 		ldr	r0, [fp, #-16]
 201 0108 FEFFFFEB 		bl	__aeabi_idiv
 202 010c 0030A0E1 		mov	r3, r0
 203              		.loc 2 254 23
 204 0110 7330EFE6 		uxtb	r3, r3
 205              		.loc 2 254 37
 206 0114 303083E2 		add	r3, r3, #48
 207 0118 7330EFE6 		uxtb	r3, r3
 208              		.loc 2 254 9
 209 011c 7330AFE6 		sxtb	r3, r3
 210 0120 0300A0E1 		mov	r0, r3
 211 0124 FEFFFFEB 		bl	__USR_Putchar
 255:Include/benchmark.h ****         Iter=Iter%Div;
 212              		.loc 2 255 13
 213 0128 10301BE5 		ldr	r3, [fp, #-16]
 214 012c 18101BE5 		ldr	r1, [fp, #-24]
 215 0130 0300A0E1 		mov	r0, r3
 216 0134 FEFFFFEB 		bl	__aeabi_idivmod
 217 0138 0130A0E1 		mov	r3, r1
 218 013c 10300BE5 		str	r3, [fp, #-16]
 256:Include/benchmark.h ****         Div/=10;
 219              		.loc 2 256 12
 220 0140 18201BE5 		ldr	r2, [fp, #-24]
 221 0144 673606E3 		movw	r3, #26215
 222 0148 663646E3 		movt	r3, 26214
 223 014c 9312C3E0 		smull	r1, r3, r3, r2
 224 0150 4311A0E1 		asr	r1, r3, #2
 225 0154 C23FA0E1 		asr	r3, r2, #31
 226 0158 033041E0 		sub	r3, r1, r3
 227 015c 18300BE5 		str	r3, [fp, #-24]
 228              	.L13:
 251:Include/benchmark.h ****     {
 229              		.loc 2 251 16
 230 0160 14301BE5 		ldr	r3, [fp, #-20]
 231 0164 000053E3 		cmp	r3, #0
 232 0168 E1FFFFCA 		bgt	.L14
 257:Include/benchmark.h ****     }
 258:Include/benchmark.h **** 
 259:Include/benchmark.h ****     return Num;
 233              		.loc 2 259 12
 234 016c 08301BE5 		ldr	r3, [fp, #-8]
 235              	.L6:
 260:Include/benchmark.h **** }
 236              		.loc 2 260 1
 237 0170 0300A0E1 		mov	r0, r3
 238 0174 04D04BE2 		sub	sp, fp, #4
 239              		.cfi_def_cfa 13, 8
 240              		@ sp needed
 241 0178 0088BDE8 		pop	{fp, pc}
 242              		.cfi_endproc
 243              	.LFE1:
 245              		.section	.text.USR_DBG_H,"ax",%progbits
 246              		.align	2
 247              		.global	USR_DBG_H
 248              		.syntax unified
 249              		.arm
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 10


 251              	USR_DBG_H:
 252              	.LFB2:
 261:Include/benchmark.h **** /* End Function:USR_DBG_I ************************************************/
 262:Include/benchmark.h **** 
 263:Include/benchmark.h **** /* Function:USR_DBG_H *****************************************************
 264:Include/benchmark.h **** Description : Print a unsigned integer on the debugging console. This integer is
 265:Include/benchmark.h ****               printed as hexadecimal.
 266:Include/benchmark.h **** Input       : rme_ptr_t Uint - The unsigned integer to print.
 267:Include/benchmark.h **** Output      : None.
 268:Include/benchmark.h **** Return      : rme_cnt_t - The length of the string printed.
 269:Include/benchmark.h **** ******************************************************************************/
 270:Include/benchmark.h **** cnt_t USR_DBG_H(ptr_t Uint)
 271:Include/benchmark.h **** {
 253              		.loc 2 271 1
 254              		.cfi_startproc
 255              		@ args = 0, pretend = 0, frame = 24
 256              		@ frame_needed = 1, uses_anonymous_args = 0
 257 0000 00482DE9 		push	{fp, lr}
 258              		.cfi_def_cfa_offset 8
 259              		.cfi_offset 11, -8
 260              		.cfi_offset 14, -4
 261 0004 04B08DE2 		add	fp, sp, #4
 262              		.cfi_def_cfa 11, 4
 263 0008 18D04DE2 		sub	sp, sp, #24
 264 000c 18000BE5 		str	r0, [fp, #-24]
 272:Include/benchmark.h ****     ptr_t Iter;
 273:Include/benchmark.h ****     ptr_t Count;
 274:Include/benchmark.h ****     ptr_t Num;
 275:Include/benchmark.h **** 
 276:Include/benchmark.h ****     /* Exit on zero */
 277:Include/benchmark.h ****     if(Uint==0U)
 265              		.loc 2 277 7
 266 0010 18301BE5 		ldr	r3, [fp, #-24]
 267 0014 000053E3 		cmp	r3, #0
 268 0018 0300001A 		bne	.L17
 278:Include/benchmark.h ****     {
 279:Include/benchmark.h ****         __USR_Putchar('0');
 269              		.loc 2 279 9
 270 001c 3000A0E3 		mov	r0, #48
 271 0020 FEFFFFEB 		bl	__USR_Putchar
 280:Include/benchmark.h ****         return 1;
 272              		.loc 2 280 16
 273 0024 0130A0E3 		mov	r3, #1
 274 0028 330000EA 		b	.L18
 275              	.L17:
 281:Include/benchmark.h ****     }
 282:Include/benchmark.h ****     else
 283:Include/benchmark.h ****     {
 284:Include/benchmark.h ****         /* No action required */
 285:Include/benchmark.h ****     }
 286:Include/benchmark.h **** 
 287:Include/benchmark.h ****     /* Filter out all the zeroes */
 288:Include/benchmark.h ****     Count=0U;
 276              		.loc 2 288 10
 277 002c 0030A0E3 		mov	r3, #0
 278 0030 0C300BE5 		str	r3, [fp, #-12]
 289:Include/benchmark.h ****     Iter=Uint;
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 11


 279              		.loc 2 289 9
 280 0034 18301BE5 		ldr	r3, [fp, #-24]
 281 0038 08300BE5 		str	r3, [fp, #-8]
 290:Include/benchmark.h ****     while((Iter>>(RME_WORD_BIT-4U))==0U)
 282              		.loc 2 290 10
 283 003c 050000EA 		b	.L19
 284              	.L20:
 291:Include/benchmark.h ****     {
 292:Include/benchmark.h ****         Iter<<=4;
 285              		.loc 2 292 13
 286 0040 08301BE5 		ldr	r3, [fp, #-8]
 287 0044 0332A0E1 		lsl	r3, r3, #4
 288 0048 08300BE5 		str	r3, [fp, #-8]
 293:Include/benchmark.h ****         Count++;
 289              		.loc 2 293 14
 290 004c 0C301BE5 		ldr	r3, [fp, #-12]
 291 0050 013083E2 		add	r3, r3, #1
 292 0054 0C300BE5 		str	r3, [fp, #-12]
 293              	.L19:
 290:Include/benchmark.h ****     while((Iter>>(RME_WORD_BIT-4U))==0U)
 294              		.loc 2 290 16
 295 0058 08301BE5 		ldr	r3, [fp, #-8]
 296 005c 233EA0E1 		lsr	r3, r3, #28
 290:Include/benchmark.h ****     while((Iter>>(RME_WORD_BIT-4U))==0U)
 297              		.loc 2 290 36
 298 0060 000053E3 		cmp	r3, #0
 299 0064 F5FFFF0A 		beq	.L20
 294:Include/benchmark.h ****     }
 295:Include/benchmark.h **** 
 296:Include/benchmark.h ****     /* Count is the number of pts to print */
 297:Include/benchmark.h ****     Count=RME_POW2(RME_WORD_ORDER-2U)-Count;
 300              		.loc 2 297 10
 301 0068 0C301BE5 		ldr	r3, [fp, #-12]
 302 006c 083063E2 		rsb	r3, r3, #8
 303 0070 0C300BE5 		str	r3, [fp, #-12]
 298:Include/benchmark.h ****     Num=Count;
 304              		.loc 2 298 8
 305 0074 0C301BE5 		ldr	r3, [fp, #-12]
 306 0078 10300BE5 		str	r3, [fp, #-16]
 299:Include/benchmark.h ****     while(Count>0U)
 307              		.loc 2 299 10
 308 007c 1A0000EA 		b	.L21
 309              	.L23:
 300:Include/benchmark.h ****     {
 301:Include/benchmark.h ****         Count--;
 310              		.loc 2 301 14
 311 0080 0C301BE5 		ldr	r3, [fp, #-12]
 312 0084 013043E2 		sub	r3, r3, #1
 313 0088 0C300BE5 		str	r3, [fp, #-12]
 302:Include/benchmark.h ****         Iter=(Uint>>(Count<<2U))&0x0FU;
 314              		.loc 2 302 27
 315 008c 0C301BE5 		ldr	r3, [fp, #-12]
 316 0090 0331A0E1 		lsl	r3, r3, #2
 317              		.loc 2 302 19
 318 0094 18201BE5 		ldr	r2, [fp, #-24]
 319 0098 3233A0E1 		lsr	r3, r2, r3
 320              		.loc 2 302 13
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 12


 321 009c 0F3003E2 		and	r3, r3, #15
 322 00a0 08300BE5 		str	r3, [fp, #-8]
 303:Include/benchmark.h ****         if(Iter<10U)
 323              		.loc 2 303 11
 324 00a4 08301BE5 		ldr	r3, [fp, #-8]
 325 00a8 090053E3 		cmp	r3, #9
 326 00ac 0700008A 		bhi	.L22
 304:Include/benchmark.h ****         {
 305:Include/benchmark.h **** 
 306:Include/benchmark.h ****             __USR_Putchar((s8)Iter+'0');
 327              		.loc 2 306 27
 328 00b0 08301BE5 		ldr	r3, [fp, #-8]
 329 00b4 7330EFE6 		uxtb	r3, r3
 330              		.loc 2 306 35
 331 00b8 303083E2 		add	r3, r3, #48
 332 00bc 7330EFE6 		uxtb	r3, r3
 333              		.loc 2 306 13
 334 00c0 7330AFE6 		sxtb	r3, r3
 335 00c4 0300A0E1 		mov	r0, r3
 336 00c8 FEFFFFEB 		bl	__USR_Putchar
 337 00cc 060000EA 		b	.L21
 338              	.L22:
 307:Include/benchmark.h ****         }
 308:Include/benchmark.h ****         else
 309:Include/benchmark.h ****         {
 310:Include/benchmark.h **** 
 311:Include/benchmark.h ****             __USR_Putchar((s8)Iter+'A'-10);
 339              		.loc 2 311 27
 340 00d0 08301BE5 		ldr	r3, [fp, #-8]
 341 00d4 7330EFE6 		uxtb	r3, r3
 342              		.loc 2 311 39
 343 00d8 373083E2 		add	r3, r3, #55
 344 00dc 7330EFE6 		uxtb	r3, r3
 345              		.loc 2 311 13
 346 00e0 7330AFE6 		sxtb	r3, r3
 347 00e4 0300A0E1 		mov	r0, r3
 348 00e8 FEFFFFEB 		bl	__USR_Putchar
 349              	.L21:
 299:Include/benchmark.h ****     {
 350              		.loc 2 299 16
 351 00ec 0C301BE5 		ldr	r3, [fp, #-12]
 352 00f0 000053E3 		cmp	r3, #0
 353 00f4 E1FFFF1A 		bne	.L23
 312:Include/benchmark.h ****         }
 313:Include/benchmark.h ****     }
 314:Include/benchmark.h **** 
 315:Include/benchmark.h ****     return (cnt_t)Num;
 354              		.loc 2 315 12
 355 00f8 10301BE5 		ldr	r3, [fp, #-16]
 356              	.L18:
 316:Include/benchmark.h **** }
 357              		.loc 2 316 1
 358 00fc 0300A0E1 		mov	r0, r3
 359 0100 04D04BE2 		sub	sp, fp, #4
 360              		.cfi_def_cfa 13, 8
 361              		@ sp needed
 362 0104 0088BDE8 		pop	{fp, pc}
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 13


 363              		.cfi_endproc
 364              	.LFE2:
 366              		.section	.text.USR_DBG_S,"ax",%progbits
 367              		.align	2
 368              		.global	USR_DBG_S
 369              		.syntax unified
 370              		.arm
 372              	USR_DBG_S:
 373              	.LFB3:
 317:Include/benchmark.h **** /* End Function:USR_DBG_H ************************************************/
 318:Include/benchmark.h **** cnt_t USR_DBG_S(const s8* String)
 319:Include/benchmark.h **** {
 374              		.loc 2 319 1
 375              		.cfi_startproc
 376              		@ args = 0, pretend = 0, frame = 16
 377              		@ frame_needed = 1, uses_anonymous_args = 0
 378 0000 00482DE9 		push	{fp, lr}
 379              		.cfi_def_cfa_offset 8
 380              		.cfi_offset 11, -8
 381              		.cfi_offset 14, -4
 382 0004 04B08DE2 		add	fp, sp, #4
 383              		.cfi_def_cfa 11, 4
 384 0008 10D04DE2 		sub	sp, sp, #16
 385 000c 10000BE5 		str	r0, [fp, #-16]
 320:Include/benchmark.h ****     ptr_t Count;
 321:Include/benchmark.h **** 
 322:Include/benchmark.h ****     for(Count=0U;Count<255;Count++)
 386              		.loc 2 322 14
 387 0010 0030A0E3 		mov	r3, #0
 388 0014 08300BE5 		str	r3, [fp, #-8]
 389              		.loc 2 322 5
 390 0018 0E0000EA 		b	.L25
 391              	.L28:
 323:Include/benchmark.h ****     {
 324:Include/benchmark.h ****         if(String[Count]==(s8)'\0')
 392              		.loc 2 324 18
 393 001c 10201BE5 		ldr	r2, [fp, #-16]
 394 0020 08301BE5 		ldr	r3, [fp, #-8]
 395 0024 033082E0 		add	r3, r2, r3
 396 0028 D030D3E1 		ldrsb	r3, [r3]
 397              		.loc 2 324 11
 398 002c 000053E3 		cmp	r3, #0
 399 0030 0C00000A 		beq	.L30
 325:Include/benchmark.h ****         {
 326:Include/benchmark.h **** 
 327:Include/benchmark.h ****             break;
 328:Include/benchmark.h ****         }
 329:Include/benchmark.h ****         else
 330:Include/benchmark.h ****         {
 331:Include/benchmark.h ****             /* No action required */
 332:Include/benchmark.h ****         }
 333:Include/benchmark.h **** 
 334:Include/benchmark.h ****         __USR_Putchar(String[Count]);
 400              		.loc 2 334 29
 401 0034 10201BE5 		ldr	r2, [fp, #-16]
 402 0038 08301BE5 		ldr	r3, [fp, #-8]
 403 003c 033082E0 		add	r3, r2, r3
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 14


 404              		.loc 2 334 9
 405 0040 D030D3E1 		ldrsb	r3, [r3]
 406 0044 0300A0E1 		mov	r0, r3
 407 0048 FEFFFFEB 		bl	__USR_Putchar
 322:Include/benchmark.h ****     {
 408              		.loc 2 322 33 discriminator 2
 409 004c 08301BE5 		ldr	r3, [fp, #-8]
 410 0050 013083E2 		add	r3, r3, #1
 411 0054 08300BE5 		str	r3, [fp, #-8]
 412              	.L25:
 322:Include/benchmark.h ****     {
 413              		.loc 2 322 23 discriminator 1
 414 0058 08301BE5 		ldr	r3, [fp, #-8]
 415 005c FE0053E3 		cmp	r3, #254
 416 0060 EDFFFF9A 		bls	.L28
 417 0064 000000EA 		b	.L27
 418              	.L30:
 327:Include/benchmark.h ****         }
 419              		.loc 2 327 13
 420 0068 00F020E3 		nop
 421              	.L27:
 335:Include/benchmark.h ****     }
 336:Include/benchmark.h **** 
 337:Include/benchmark.h ****     return (cnt_t)Count;
 422              		.loc 2 337 12
 423 006c 08301BE5 		ldr	r3, [fp, #-8]
 338:Include/benchmark.h **** }
 424              		.loc 2 338 1
 425 0070 0300A0E1 		mov	r0, r3
 426 0074 04D04BE2 		sub	sp, fp, #4
 427              		.cfi_def_cfa 13, 8
 428              		@ sp needed
 429 0078 0088BDE8 		pop	{fp, pc}
 430              		.cfi_endproc
 431              	.LFE3:
 433              		.section	.text.RME_Thd_Crt,"ax",%progbits
 434              		.align	2
 435              		.global	RME_Thd_Crt
 436              		.syntax unified
 437              		.arm
 439              	RME_Thd_Crt:
 440              	.LFB4:
 339:Include/benchmark.h **** 
 340:Include/benchmark.h **** 
 341:Include/benchmark.h **** 
 342:Include/benchmark.h **** /* Function:RME_Thd_Crt *******************************************************
 343:Include/benchmark.h **** Description : Create a thread. A thread is the minimal kernel-level execution
 344:Include/benchmark.h ****               unit.
 345:Include/benchmark.h **** Input       : RME_cid_t Cap_Cpt - The capability to the capability table.
 346:Include/benchmark.h ****                                   2-Level.
 347:Include/benchmark.h ****               RME_cid_t Cap_Kom - The kernel memory capability.
 348:Include/benchmark.h ****                                   2-Level.
 349:Include/benchmark.h ****               RME_cid_t Cap_Thd - The capability slot that you want this newly
 350:Include/benchmark.h ****                                   created thread capability to be in.
 351:Include/benchmark.h ****                                   1-Level.
 352:Include/benchmark.h ****               RME_cid_t Cap_Prc - The capability to the process that it is in.
 353:Include/benchmark.h ****                                   2-Level.
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 15


 354:Include/benchmark.h ****               RME_ptr_t Prio_Max - The maximum priority allowed for this
 355:Include/benchmark.h ****                                    thread. Once set, this cannot be changed.
 356:Include/benchmark.h ****               RME_ptr_t Raddr - The relative virtual address to store the
 357:Include/benchmark.h ****                                 thread kernel object.
 358:Include/benchmark.h ****               RME_ptr_t Attr - The context attributes.
 359:Include/benchmark.h **** Output      : None.
 360:Include/benchmark.h **** Return      : RME_ret_t - If successful, the Thread ID; or an error code.
 361:Include/benchmark.h **** ******************************************************************************/
 362:Include/benchmark.h **** ret_t RME_Thd_Crt(cid_t Cap_Cpt,
 363:Include/benchmark.h ****                       cid_t Cap_Kom,
 364:Include/benchmark.h ****                       cid_t Cap_Thd,
 365:Include/benchmark.h ****                       cid_t Cap_Prc,
 366:Include/benchmark.h ****                       ptr_t Prio_Max,
 367:Include/benchmark.h ****                       ptr_t Raddr,
 368:Include/benchmark.h ****                       ptr_t Attr)
 369:Include/benchmark.h **** {
 441              		.loc 2 369 1
 442              		.cfi_startproc
 443              		@ args = 12, pretend = 0, frame = 16
 444              		@ frame_needed = 1, uses_anonymous_args = 0
 445 0000 00482DE9 		push	{fp, lr}
 446              		.cfi_def_cfa_offset 8
 447              		.cfi_offset 11, -8
 448              		.cfi_offset 14, -4
 449 0004 04B08DE2 		add	fp, sp, #4
 450              		.cfi_def_cfa 11, 4
 451 0008 10D04DE2 		sub	sp, sp, #16
 452 000c 08000BE5 		str	r0, [fp, #-8]
 453 0010 0C100BE5 		str	r1, [fp, #-12]
 454 0014 10200BE5 		str	r2, [fp, #-16]
 455 0018 14300BE5 		str	r3, [fp, #-20]
 370:Include/benchmark.h ****     return RME_SVC(RME_THD_SVC(Attr,0U,RME_SVC_THD_CRT),
 456              		.loc 2 370 12
 457 001c 0C309BE5 		ldr	r3, [fp, #12]
 458 0020 832BA0E1 		lsl	r2, r3, #23
 459 0024 08301BE5 		ldr	r3, [fp, #-8]
 460 0028 033082E1 		orr	r3, r2, r3
 461 002c 190883E3 		orr	r0, r3, #1638400
 462 0030 0C301BE5 		ldr	r3, [fp, #-12]
 463 0034 0328A0E1 		lsl	r2, r3, #16
 464 0038 10301BE5 		ldr	r3, [fp, #-16]
 465 003c 7330FFE6 		uxth	r3, r3
 466 0040 031082E1 		orr	r1, r2, r3
 467 0044 14301BE5 		ldr	r3, [fp, #-20]
 468 0048 0328A0E1 		lsl	r2, r3, #16
 469 004c 04309BE5 		ldr	r3, [fp, #4]
 470 0050 7330FFE6 		uxth	r3, r3
 471 0054 032082E1 		orr	r2, r2, r3
 472 0058 08309BE5 		ldr	r3, [fp, #8]
 473 005c FEFFFFEB 		bl	RME_Svc
 474 0060 0030A0E1 		mov	r3, r0
 371:Include/benchmark.h ****                    Cap_Cpt,
 372:Include/benchmark.h ****                    RME_PARAM_D1(Cap_Kom)|RME_PARAM_D0(Cap_Thd),
 373:Include/benchmark.h ****                    RME_PARAM_D1(Cap_Prc)|RME_PARAM_D0(Prio_Max),
 374:Include/benchmark.h ****                    Raddr);
 375:Include/benchmark.h **** }
 475              		.loc 2 375 1
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 16


 476 0064 0300A0E1 		mov	r0, r3
 477 0068 04D04BE2 		sub	sp, fp, #4
 478              		.cfi_def_cfa 13, 8
 479              		@ sp needed
 480 006c 0088BDE8 		pop	{fp, pc}
 481              		.cfi_endproc
 482              	.LFE4:
 484              		.section	.text.RME_Thd_Exec_Set,"ax",%progbits
 485              		.align	2
 486              		.global	RME_Thd_Exec_Set
 487              		.syntax unified
 488              		.arm
 490              	RME_Thd_Exec_Set:
 491              	.LFB5:
 376:Include/benchmark.h **** /* End Function:RME_Thd_Crt **************************************************/
 377:Include/benchmark.h **** 
 378:Include/benchmark.h **** /* Function:RME_Thd_Exec_Set **************************************************
 379:Include/benchmark.h **** Description : Set a thread's entry point and stack. The registers will be
 380:Include/benchmark.h ****               initialized with these contents.
 381:Include/benchmark.h **** Input       : RME_cid_t Cap_Thd - The capability to the thread.
 382:Include/benchmark.h ****                                   2-Level.
 383:Include/benchmark.h ****               void* Entry - The entry address of the thread.
 384:Include/benchmark.h ****               void* Stack - The stack address to use for execution.
 385:Include/benchmark.h ****               void* Param - The parameter to pass to the thread.
 386:Include/benchmark.h **** Output      : None.
 387:Include/benchmark.h **** Return      : RME_ret_t - If successful, 0; or an error code.
 388:Include/benchmark.h **** ******************************************************************************/
 389:Include/benchmark.h **** ret_t RME_Thd_Exec_Set(cid_t Cap_Thd,
 390:Include/benchmark.h ****                            ptr_t Entry,
 391:Include/benchmark.h ****                            ptr_t Stack,
 392:Include/benchmark.h ****                            ptr_t Param)
 393:Include/benchmark.h **** {
 492              		.loc 2 393 1
 493              		.cfi_startproc
 494              		@ args = 0, pretend = 0, frame = 16
 495              		@ frame_needed = 1, uses_anonymous_args = 0
 496 0000 00482DE9 		push	{fp, lr}
 497              		.cfi_def_cfa_offset 8
 498              		.cfi_offset 11, -8
 499              		.cfi_offset 14, -4
 500 0004 04B08DE2 		add	fp, sp, #4
 501              		.cfi_def_cfa 11, 4
 502 0008 10D04DE2 		sub	sp, sp, #16
 503 000c 08000BE5 		str	r0, [fp, #-8]
 504 0010 0C100BE5 		str	r1, [fp, #-12]
 505 0014 10200BE5 		str	r2, [fp, #-16]
 506 0018 14300BE5 		str	r3, [fp, #-20]
 394:Include/benchmark.h ****     return RME_SVC(RME_SVC_THD_EXEC_SET,
 507              		.loc 2 394 12
 508 001c 08301BE5 		ldr	r3, [fp, #-8]
 509 0020 060883E3 		orr	r0, r3, #393216
 510 0024 14301BE5 		ldr	r3, [fp, #-20]
 511 0028 10201BE5 		ldr	r2, [fp, #-16]
 512 002c 0C101BE5 		ldr	r1, [fp, #-12]
 513 0030 FEFFFFEB 		bl	RME_Svc
 514 0034 0030A0E1 		mov	r3, r0
 395:Include/benchmark.h ****                    Cap_Thd,
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 17


 396:Include/benchmark.h ****                    (ptr_t)Entry,
 397:Include/benchmark.h ****                    (ptr_t)Stack,
 398:Include/benchmark.h ****                    (ptr_t)Param);
 399:Include/benchmark.h **** }
 515              		.loc 2 399 1
 516 0038 0300A0E1 		mov	r0, r3
 517 003c 04D04BE2 		sub	sp, fp, #4
 518              		.cfi_def_cfa 13, 8
 519              		@ sp needed
 520 0040 0088BDE8 		pop	{fp, pc}
 521              		.cfi_endproc
 522              	.LFE5:
 524              		.section	.text.RME_Thd_Time_Xfer,"ax",%progbits
 525              		.align	2
 526              		.global	RME_Thd_Time_Xfer
 527              		.syntax unified
 528              		.arm
 530              	RME_Thd_Time_Xfer:
 531              	.LFB6:
 400:Include/benchmark.h **** /* End Function:RME_Thd_Exec_Set *********************************************/
 401:Include/benchmark.h **** 
 402:Include/benchmark.h **** /* Function:RME_Thd_Time_Xfer *************************************************
 403:Include/benchmark.h **** Description : Transfer time from one thread to another. This can only be called
 404:Include/benchmark.h ****               from the core that the thread is on, and the the two threads
 405:Include/benchmark.h ****               involved in the time transfer must be on the same core.
 406:Include/benchmark.h ****               If the time transfered is more than or equal to what the source
 407:Include/benchmark.h ****               have, the source will be out of time or blocked. If the source is
 408:Include/benchmark.h ****               both out of time and blocked, we do not send the notification;
 409:Include/benchmark.h ****               Instead, we send the notification when the receive endpoint
 410:Include/benchmark.h ****               actually receive something.
 411:Include/benchmark.h ****               It is possible to transfer time to threads have a lower priority,
 412:Include/benchmark.h ****               and it is also possible to transfer time to threads that have a
 413:Include/benchmark.h ****               higher priority. In the latter case, and if the source is
 414:Include/benchmark.h ****               currently running, a preemption will occur.
 415:Include/benchmark.h **** Input       : RME_cid_t Cap_Thd_Dst - The destination thread.
 416:Include/benchmark.h ****                                       2-Level.
 417:Include/benchmark.h ****               RME_cid_t Cap_Thd_Src - The source thread.
 418:Include/benchmark.h ****                                       2-Level.
 419:Include/benchmark.h ****               RME_ptr_t Time - The time to transfer, in slices. A slice is the
 420:Include/benchmark.h ****                                minimal amount of time transfered in the system
 421:Include/benchmark.h ****                                usually on the order of 100us or 1ms.
 422:Include/benchmark.h ****                                Use RME_THD_INIT_TIME for revoking transfer.
 423:Include/benchmark.h ****                                Use RME_THD_INF_TIME for infinite trasnfer.
 424:Include/benchmark.h **** Output      : None.
 425:Include/benchmark.h **** Return      : RME_ret_t - If successful, the destination time amount; or an
 426:Include/benchmark.h ****                           error code.
 427:Include/benchmark.h **** ******************************************************************************/
 428:Include/benchmark.h **** ret_t RME_Thd_Time_Xfer(cid_t Cap_Thd_Dst,
 429:Include/benchmark.h ****                         cid_t Cap_Thd_Src,
 430:Include/benchmark.h ****                         ptr_t Time)
 431:Include/benchmark.h **** {
 532              		.loc 2 431 1
 533              		.cfi_startproc
 534              		@ args = 0, pretend = 0, frame = 16
 535              		@ frame_needed = 1, uses_anonymous_args = 0
 536 0000 00482DE9 		push	{fp, lr}
 537              		.cfi_def_cfa_offset 8
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 18


 538              		.cfi_offset 11, -8
 539              		.cfi_offset 14, -4
 540 0004 04B08DE2 		add	fp, sp, #4
 541              		.cfi_def_cfa 11, 4
 542 0008 10D04DE2 		sub	sp, sp, #16
 543 000c 08000BE5 		str	r0, [fp, #-8]
 544 0010 0C100BE5 		str	r1, [fp, #-12]
 545 0014 10200BE5 		str	r2, [fp, #-16]
 432:Include/benchmark.h ****     return RME_SVC(RME_SVC_THD_TIME_XFER,
 546              		.loc 2 432 12
 547 0018 08101BE5 		ldr	r1, [fp, #-8]
 548 001c 0C201BE5 		ldr	r2, [fp, #-12]
 549 0020 10301BE5 		ldr	r3, [fp, #-16]
 550 0024 0207A0E3 		mov	r0, #524288
 551 0028 FEFFFFEB 		bl	RME_Svc
 552 002c 0030A0E1 		mov	r3, r0
 433:Include/benchmark.h ****                    0U,
 434:Include/benchmark.h ****                    Cap_Thd_Dst,
 435:Include/benchmark.h ****                    Cap_Thd_Src,
 436:Include/benchmark.h ****                    Time);
 437:Include/benchmark.h **** }
 553              		.loc 2 437 1
 554 0030 0300A0E1 		mov	r0, r3
 555 0034 04D04BE2 		sub	sp, fp, #4
 556              		.cfi_def_cfa 13, 8
 557              		@ sp needed
 558 0038 0088BDE8 		pop	{fp, pc}
 559              		.cfi_endproc
 560              	.LFE6:
 562              		.section	.text.RME_Thd_Sched_Bind,"ax",%progbits
 563              		.align	2
 564              		.global	RME_Thd_Sched_Bind
 565              		.syntax unified
 566              		.arm
 568              	RME_Thd_Sched_Bind:
 569              	.LFB7:
 438:Include/benchmark.h **** /* End Function:RME_Thd_Time_Xfer ********************************************/
 439:Include/benchmark.h **** 
 440:Include/benchmark.h **** 
 441:Include/benchmark.h **** /* Function:RME_Thd_Sched_Bind ************************************************
 442:Include/benchmark.h **** Description : Set a thread's priority level, and its scheduler thread. When
 443:Include/benchmark.h ****               there are any state changes on this thread, a notification will
 444:Include/benchmark.h ****               be sent to its scheduler thread. If the state of the thread
 445:Include/benchmark.h ****               changes for multiple times, then only the most recent state will
 446:Include/benchmark.h ****               be reflected in the scheduler's receive queue.
 447:Include/benchmark.h ****               The scheduler and the threads that it schedule must be on the
 448:Include/benchmark.h ****               same core. When a thread wants to go from one core to another,
 449:Include/benchmark.h ****               its notification to the scheduler must all be processed, and it
 450:Include/benchmark.h ****               must have no scheduler notifications in itself.
 451:Include/benchmark.h ****               This must be called on the same core with the Cap_Thd_Sched, and
 452:Include/benchmark.h ****               the Cap_Thd itself must be free.
 453:Include/benchmark.h ****               It is impossible to set a thread's priority beyond its maximum
 454:Include/benchmark.h ****               priority.
 455:Include/benchmark.h **** Input       : RME_cid_t Cap_Thd - The capability to the thread.
 456:Include/benchmark.h ****                                   2-Level.
 457:Include/benchmark.h ****               RME_cid_t Cap_Thd_Sched - The scheduler thread.
 458:Include/benchmark.h ****                                         2-Level.
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 19


 459:Include/benchmark.h ****               RME_cid_t Cap_Sig - The signal endpoint for scheduler
 460:Include/benchmark.h ****                                   notifications. This signal endpoint will be
 461:Include/benchmark.h ****                                   sent to whenever this thread has a fault, or
 462:Include/benchmark.h ****                                   timeouts. This is purely optional; if it is
 463:Include/benchmark.h ****                                   not needed, pass in RME_CID_NULL.
 464:Include/benchmark.h ****               RME_tid_t TID - The thread ID. This is user-supplied, and the
 465:Include/benchmark.h ****                               kernel will not check whether there are two
 466:Include/benchmark.h ****                               threads that have the same TID.
 467:Include/benchmark.h ****               RME_ptr_t Prio - The priority level, higher is more critical.
 468:Include/benchmark.h **** Output      : None.
 469:Include/benchmark.h **** Return      : RME_ret_t - If successful, 0; or an error code.
 470:Include/benchmark.h **** ******************************************************************************/
 471:Include/benchmark.h **** ret_t RME_Thd_Sched_Bind(cid_t Cap_Thd,
 472:Include/benchmark.h ****                          cid_t Cap_Thd_Sched,
 473:Include/benchmark.h ****                          cid_t Cap_Sig,
 474:Include/benchmark.h ****                          tid_t TID,
 475:Include/benchmark.h ****                          ptr_t Prio,
 476:Include/benchmark.h ****                          ptr_t Haddr)
 477:Include/benchmark.h **** {
 570              		.loc 2 477 1
 571              		.cfi_startproc
 572              		@ args = 8, pretend = 0, frame = 16
 573              		@ frame_needed = 1, uses_anonymous_args = 0
 574 0000 00482DE9 		push	{fp, lr}
 575              		.cfi_def_cfa_offset 8
 576              		.cfi_offset 11, -8
 577              		.cfi_offset 14, -4
 578 0004 04B08DE2 		add	fp, sp, #4
 579              		.cfi_def_cfa 11, 4
 580 0008 10D04DE2 		sub	sp, sp, #16
 581 000c 08000BE5 		str	r0, [fp, #-8]
 582 0010 0C100BE5 		str	r1, [fp, #-12]
 583 0014 10200BE5 		str	r2, [fp, #-16]
 584 0018 14300BE5 		str	r3, [fp, #-20]
 478:Include/benchmark.h ****     return RME_SVC(RME_SVC_THD_SCHED_BIND,
 585              		.loc 2 478 12
 586 001c 08301BE5 		ldr	r3, [fp, #-8]
 587 0020 1B0883E3 		orr	r0, r3, #1769472
 588 0024 0C301BE5 		ldr	r3, [fp, #-12]
 589 0028 0328A0E1 		lsl	r2, r3, #16
 590 002c 10301BE5 		ldr	r3, [fp, #-16]
 591 0030 7330FFE6 		uxth	r3, r3
 592 0034 031082E1 		orr	r1, r2, r3
 593 0038 14301BE5 		ldr	r3, [fp, #-20]
 594 003c 0328A0E1 		lsl	r2, r3, #16
 595 0040 04309BE5 		ldr	r3, [fp, #4]
 596 0044 7330FFE6 		uxth	r3, r3
 597 0048 032082E1 		orr	r2, r2, r3
 598 004c 08309BE5 		ldr	r3, [fp, #8]
 599 0050 FEFFFFEB 		bl	RME_Svc
 600 0054 0030A0E1 		mov	r3, r0
 479:Include/benchmark.h ****                    Cap_Thd,
 480:Include/benchmark.h ****                    RME_PARAM_D1(Cap_Thd_Sched)|RME_PARAM_D0(Cap_Sig),
 481:Include/benchmark.h ****                    RME_PARAM_D1(TID)|RME_PARAM_D0(Prio),
 482:Include/benchmark.h ****                    Haddr);
 483:Include/benchmark.h **** }
 601              		.loc 2 483 1
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 20


 602 0058 0300A0E1 		mov	r0, r3
 603 005c 04D04BE2 		sub	sp, fp, #4
 604              		.cfi_def_cfa 13, 8
 605              		@ sp needed
 606 0060 0088BDE8 		pop	{fp, pc}
 607              		.cfi_endproc
 608              	.LFE7:
 610              		.section	.text.RME_Thd_Swt,"ax",%progbits
 611              		.align	2
 612              		.global	RME_Thd_Swt
 613              		.syntax unified
 614              		.arm
 616              	RME_Thd_Swt:
 617              	.LFB8:
 484:Include/benchmark.h **** /* End Function:RME_Thd_Sched_Bind *******************************************/
 485:Include/benchmark.h **** 
 486:Include/benchmark.h **** 
 487:Include/benchmark.h **** /* Function:RME_Thd_Swt *******************************************************
 488:Include/benchmark.h **** Description : Switch to another thread. The thread to switch to must have the
 489:Include/benchmark.h ****               same preemptive priority as this thread, and have time, and not
 490:Include/benchmark.h ****               blocked.
 491:Include/benchmark.h **** Input       : RME_cid_t Cap_Thd - The capability to the thread. If this is -1,
 492:Include/benchmark.h ****                                   the kernel will pickup whatever thread that
 493:Include/benchmark.h ****                                   has the highest priority and time to run.
 494:Include/benchmark.h ****                                   2-Level.
 495:Include/benchmark.h ****               RME_ptr_t Is_Yield - This is a flag to indicate whether this
 496:Include/benchmark.h ****                                    is a full yield. If it is, the kernel will
 497:Include/benchmark.h ****                                    discard all the time alloted on this
 498:Include/benchmark.h ****                                    thread.
 499:Include/benchmark.h **** Output      : None.
 500:Include/benchmark.h **** Return      : RME_ret_t - If successful, 0; or an error code.
 501:Include/benchmark.h **** ******************************************************************************/
 502:Include/benchmark.h **** ret_t RME_Thd_Swt(cid_t Cap_Thd,
 503:Include/benchmark.h ****                   ptr_t Is_Yield)
 504:Include/benchmark.h **** {
 618              		.loc 2 504 1
 619              		.cfi_startproc
 620              		@ args = 0, pretend = 0, frame = 8
 621              		@ frame_needed = 1, uses_anonymous_args = 0
 622 0000 00482DE9 		push	{fp, lr}
 623              		.cfi_def_cfa_offset 8
 624              		.cfi_offset 11, -8
 625              		.cfi_offset 14, -4
 626 0004 04B08DE2 		add	fp, sp, #4
 627              		.cfi_def_cfa 11, 4
 628 0008 08D04DE2 		sub	sp, sp, #8
 629 000c 08000BE5 		str	r0, [fp, #-8]
 630 0010 0C100BE5 		str	r1, [fp, #-12]
 505:Include/benchmark.h ****     return RME_SVC(RME_SVC_THD_SWT,
 631              		.loc 2 505 12
 632 0014 08101BE5 		ldr	r1, [fp, #-8]
 633 0018 0030A0E3 		mov	r3, #0
 634 001c 0C201BE5 		ldr	r2, [fp, #-12]
 635 0020 0908A0E3 		mov	r0, #589824
 636 0024 FEFFFFEB 		bl	RME_Svc
 637 0028 0030A0E1 		mov	r3, r0
 506:Include/benchmark.h ****                    0U,
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 21


 507:Include/benchmark.h ****                    Cap_Thd,
 508:Include/benchmark.h ****                    Is_Yield,
 509:Include/benchmark.h ****                    0U);
 510:Include/benchmark.h **** }
 638              		.loc 2 510 1
 639 002c 0300A0E1 		mov	r0, r3
 640 0030 04D04BE2 		sub	sp, fp, #4
 641              		.cfi_def_cfa 13, 8
 642              		@ sp needed
 643 0034 0088BDE8 		pop	{fp, pc}
 644              		.cfi_endproc
 645              	.LFE8:
 647              		.section	.text.RME_Sig_Crt,"ax",%progbits
 648              		.align	2
 649              		.global	RME_Sig_Crt
 650              		.syntax unified
 651              		.arm
 653              	RME_Sig_Crt:
 654              	.LFB9:
 511:Include/benchmark.h **** /* End Function:RME_Thd_Swt **************************************************/
 512:Include/benchmark.h **** /*asynchronous communication function*/
 513:Include/benchmark.h **** /* Function:RME_Sig_Crt *******************************************************
 514:Include/benchmark.h **** Description : Create a signal endpoint.
 515:Include/benchmark.h **** Input       : RME_cid_t Cap_Cpt - The capability to the capability table to use
 516:Include/benchmark.h ****                                   for this signal.
 517:Include/benchmark.h ****                                   2-Level.
 518:Include/benchmark.h ****               RME_cid_t Cap_Sig - The capability slot that you want this newly
 519:Include/benchmark.h ****                                   created signal capability to be in.
 520:Include/benchmark.h ****                                   1-Level.
 521:Include/benchmark.h **** Output      : None.
 522:Include/benchmark.h **** Return      : RME_ret_t - If successful, 0; or an error code.
 523:Include/benchmark.h **** ******************************************************************************/
 524:Include/benchmark.h **** ret_t RME_Sig_Crt(cid_t Cap_Cpt,
 525:Include/benchmark.h ****                   cid_t Cap_Sig)
 526:Include/benchmark.h **** {
 655              		.loc 2 526 1
 656              		.cfi_startproc
 657              		@ args = 0, pretend = 0, frame = 8
 658              		@ frame_needed = 1, uses_anonymous_args = 0
 659 0000 00482DE9 		push	{fp, lr}
 660              		.cfi_def_cfa_offset 8
 661              		.cfi_offset 11, -8
 662              		.cfi_offset 14, -4
 663 0004 04B08DE2 		add	fp, sp, #4
 664              		.cfi_def_cfa 11, 4
 665 0008 08D04DE2 		sub	sp, sp, #8
 666 000c 08000BE5 		str	r0, [fp, #-8]
 667 0010 0C100BE5 		str	r1, [fp, #-12]
 527:Include/benchmark.h ****     return RME_SVC(RME_SVC_SIG_CRT,
 668              		.loc 2 527 12
 669 0014 08301BE5 		ldr	r3, [fp, #-8]
 670 0018 1D0883E3 		orr	r0, r3, #1900544
 671 001c 0C101BE5 		ldr	r1, [fp, #-12]
 672 0020 0030A0E3 		mov	r3, #0
 673 0024 0020A0E3 		mov	r2, #0
 674 0028 FEFFFFEB 		bl	RME_Svc
 675 002c 0030A0E1 		mov	r3, r0
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 22


 528:Include/benchmark.h ****                    Cap_Cpt,
 529:Include/benchmark.h ****                    Cap_Sig,
 530:Include/benchmark.h ****                    0U,
 531:Include/benchmark.h ****                    0U);
 532:Include/benchmark.h **** }
 676              		.loc 2 532 1
 677 0030 0300A0E1 		mov	r0, r3
 678 0034 04D04BE2 		sub	sp, fp, #4
 679              		.cfi_def_cfa 13, 8
 680              		@ sp needed
 681 0038 0088BDE8 		pop	{fp, pc}
 682              		.cfi_endproc
 683              	.LFE9:
 685              		.section	.text.RME_Sig_Del,"ax",%progbits
 686              		.align	2
 687              		.global	RME_Sig_Del
 688              		.syntax unified
 689              		.arm
 691              	RME_Sig_Del:
 692              	.LFB10:
 533:Include/benchmark.h **** /* End Function:RME_Sig_Crt **************************************************/
 534:Include/benchmark.h **** /* Function:RME_Sig_Del *******************************************************
 535:Include/benchmark.h **** Description : Delete a signal endpoint.
 536:Include/benchmark.h **** Input       : RME_cid_t Cap_Cpt - The capability to the capability table to
 537:Include/benchmark.h ****                                   delete from.
 538:Include/benchmark.h ****                                   2-Level.
 539:Include/benchmark.h ****               RME_cid_t Cap_Sig - The capability to the signal.
 540:Include/benchmark.h ****                                   1-Level.
 541:Include/benchmark.h **** Output      : None.
 542:Include/benchmark.h **** Return      : RME_ret_t - If successful, 0; or an error code.
 543:Include/benchmark.h **** ******************************************************************************/
 544:Include/benchmark.h **** ret_t RME_Sig_Del(cid_t Cap_Cpt,
 545:Include/benchmark.h ****                   cid_t Cap_Sig)
 546:Include/benchmark.h **** {
 693              		.loc 2 546 1
 694              		.cfi_startproc
 695              		@ args = 0, pretend = 0, frame = 8
 696              		@ frame_needed = 1, uses_anonymous_args = 0
 697 0000 00482DE9 		push	{fp, lr}
 698              		.cfi_def_cfa_offset 8
 699              		.cfi_offset 11, -8
 700              		.cfi_offset 14, -4
 701 0004 04B08DE2 		add	fp, sp, #4
 702              		.cfi_def_cfa 11, 4
 703 0008 08D04DE2 		sub	sp, sp, #8
 704 000c 08000BE5 		str	r0, [fp, #-8]
 705 0010 0C100BE5 		str	r1, [fp, #-12]
 547:Include/benchmark.h ****     return RME_SVC(RME_SVC_SIG_DEL,
 706              		.loc 2 547 12
 707 0014 08301BE5 		ldr	r3, [fp, #-8]
 708 0018 1E0883E3 		orr	r0, r3, #1966080
 709 001c 0C101BE5 		ldr	r1, [fp, #-12]
 710 0020 0030A0E3 		mov	r3, #0
 711 0024 0020A0E3 		mov	r2, #0
 712 0028 FEFFFFEB 		bl	RME_Svc
 713 002c 0030A0E1 		mov	r3, r0
 548:Include/benchmark.h ****                    Cap_Cpt,
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 23


 549:Include/benchmark.h ****                    Cap_Sig,
 550:Include/benchmark.h ****                    0U,
 551:Include/benchmark.h ****                    0U);
 552:Include/benchmark.h **** }
 714              		.loc 2 552 1
 715 0030 0300A0E1 		mov	r0, r3
 716 0034 04D04BE2 		sub	sp, fp, #4
 717              		.cfi_def_cfa 13, 8
 718              		@ sp needed
 719 0038 0088BDE8 		pop	{fp, pc}
 720              		.cfi_endproc
 721              	.LFE10:
 723              		.section	.text.RME_Sig_Snd,"ax",%progbits
 724              		.align	2
 725              		.global	RME_Sig_Snd
 726              		.syntax unified
 727              		.arm
 729              	RME_Sig_Snd:
 730              	.LFB11:
 553:Include/benchmark.h **** /* End Function:RME_Sig_Del **************************************************/
 554:Include/benchmark.h **** /* Function:RME_Sig_Snd ******************************************************
 555:Include/benchmark.h **** Description : Try to send to a signal endpoint. This system call can cause
 556:Include/benchmark.h ****               a potential context switch.
 557:Include/benchmark.h **** Input       : RME_cid_t Cap_Sig - The capability to the signal.
 558:Include/benchmark.h ****                                   2-Level.
 559:Include/benchmark.h **** Output      : None.
 560:Include/benchmark.h **** Return      : RME_ret_t - If successful, 0, or an error code.
 561:Include/benchmark.h **** ******************************************************************************/
 562:Include/benchmark.h **** ret_t RME_Sig_Snd(cid_t Cap_Sig)
 563:Include/benchmark.h **** {
 731              		.loc 2 563 1
 732              		.cfi_startproc
 733              		@ args = 0, pretend = 0, frame = 8
 734              		@ frame_needed = 1, uses_anonymous_args = 0
 735 0000 00482DE9 		push	{fp, lr}
 736              		.cfi_def_cfa_offset 8
 737              		.cfi_offset 11, -8
 738              		.cfi_offset 14, -4
 739 0004 04B08DE2 		add	fp, sp, #4
 740              		.cfi_def_cfa 11, 4
 741 0008 08D04DE2 		sub	sp, sp, #8
 742 000c 08000BE5 		str	r0, [fp, #-8]
 564:Include/benchmark.h ****     return RME_SVC(RME_SVC_SIG_SND,
 743              		.loc 2 564 12
 744 0010 08101BE5 		ldr	r1, [fp, #-8]
 745 0014 0030A0E3 		mov	r3, #0
 746 0018 0020A0E3 		mov	r2, #0
 747 001c 0208A0E3 		mov	r0, #131072
 748 0020 FEFFFFEB 		bl	RME_Svc
 749 0024 0030A0E1 		mov	r3, r0
 565:Include/benchmark.h ****                    0U,
 566:Include/benchmark.h ****                    Cap_Sig,
 567:Include/benchmark.h ****                    0U,
 568:Include/benchmark.h ****                    0U);
 569:Include/benchmark.h **** }
 750              		.loc 2 569 1
 751 0028 0300A0E1 		mov	r0, r3
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 24


 752 002c 04D04BE2 		sub	sp, fp, #4
 753              		.cfi_def_cfa 13, 8
 754              		@ sp needed
 755 0030 0088BDE8 		pop	{fp, pc}
 756              		.cfi_endproc
 757              	.LFE11:
 759              		.section	.text.RME_Sig_Rcv,"ax",%progbits
 760              		.align	2
 761              		.global	RME_Sig_Rcv
 762              		.syntax unified
 763              		.arm
 765              	RME_Sig_Rcv:
 766              	.LFB12:
 570:Include/benchmark.h **** /* End Function:RME_Sig_Snd **************************************************/
 571:Include/benchmark.h **** /* Function:RME_Sig_Rcv *******************************************************
 572:Include/benchmark.h **** Description : Try to receive from a signal endpoint. The rules for signal
 573:Include/benchmark.h ****               endpoint receive is:
 574:Include/benchmark.h ****               1.If a receive endpoint have many send endpoints, everyone can
 575:Include/benchmark.h ****                 send to it, and sending to it will increase the count by 1.
 576:Include/benchmark.h ****               2.If some thread blocks on a receive endpoint, the wakeup is only
 577:Include/benchmark.h ****                 possible from the same core that thread is on.
 578:Include/benchmark.h ****               3.It is not recommended to let 2 cores operate on the rcv
 579:Include/benchmark.h ****                 endpoint simutaneously.
 580:Include/benchmark.h ****               This system call can potentially trigger a context switch.
 581:Include/benchmark.h **** Input       : RME_cid_t Cap_Sig - The capability to the signal.
 582:Include/benchmark.h ****                                   2-Level.
 583:Include/benchmark.h ****               RME_ptr_t Option - The receive option.
 584:Include/benchmark.h **** Output      : None.
 585:Include/benchmark.h **** Return      : RME_ret_t - If successful, a non-negative number containing the
 586:Include/benchmark.h ****                           number of signals received; or an error code.
 587:Include/benchmark.h **** ******************************************************************************/
 588:Include/benchmark.h **** ret_t RME_Sig_Rcv(cid_t Cap_Sig,
 589:Include/benchmark.h ****                   ptr_t Option)
 590:Include/benchmark.h **** {
 767              		.loc 2 590 1
 768              		.cfi_startproc
 769              		@ args = 0, pretend = 0, frame = 8
 770              		@ frame_needed = 1, uses_anonymous_args = 0
 771 0000 00482DE9 		push	{fp, lr}
 772              		.cfi_def_cfa_offset 8
 773              		.cfi_offset 11, -8
 774              		.cfi_offset 14, -4
 775 0004 04B08DE2 		add	fp, sp, #4
 776              		.cfi_def_cfa 11, 4
 777 0008 08D04DE2 		sub	sp, sp, #8
 778 000c 08000BE5 		str	r0, [fp, #-8]
 779 0010 0C100BE5 		str	r1, [fp, #-12]
 591:Include/benchmark.h ****     return RME_SVC(RME_SVC_SIG_RCV,
 780              		.loc 2 591 12
 781 0014 08101BE5 		ldr	r1, [fp, #-8]
 782 0018 0030A0E3 		mov	r3, #0
 783 001c 0C201BE5 		ldr	r2, [fp, #-12]
 784 0020 0308A0E3 		mov	r0, #196608
 785 0024 FEFFFFEB 		bl	RME_Svc
 786 0028 0030A0E1 		mov	r3, r0
 592:Include/benchmark.h ****                    0U,
 593:Include/benchmark.h ****                    Cap_Sig,
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 25


 594:Include/benchmark.h ****                    Option,
 595:Include/benchmark.h ****                    0U);
 596:Include/benchmark.h **** }
 787              		.loc 2 596 1
 788 002c 0300A0E1 		mov	r0, r3
 789 0030 04D04BE2 		sub	sp, fp, #4
 790              		.cfi_def_cfa 13, 8
 791              		@ sp needed
 792 0034 0088BDE8 		pop	{fp, pc}
 793              		.cfi_endproc
 794              	.LFE12:
 796              		.section	.text._RME_Tsc_Init,"ax",%progbits
 797              		.align	2
 798              		.global	_RME_Tsc_Init
 799              		.syntax unified
 800              		.arm
 802              	_RME_Tsc_Init:
 803              	.LFB13:
   1:Source/rme_benchmark.c **** /******************************************************************************
   2:Source/rme_benchmark.c **** Filename    : benchmark.c
   3:Source/rme_benchmark.c **** Author      : pry
   4:Source/rme_benchmark.c **** Date        : 04/09/2017
   5:Source/rme_benchmark.c **** Licence     : The Unlicense; see LICENSE for details.
   6:Source/rme_benchmark.c **** Description : The benchmark file for RME.
   7:Source/rme_benchmark.c **** ******************************************************************************/
   8:Source/rme_benchmark.c **** 
   9:Source/rme_benchmark.c **** /* Include *******************************************************************/
  10:Source/rme_benchmark.c **** #include"benchmark.h"
  11:Source/rme_benchmark.c **** 
  12:Source/rme_benchmark.c **** /* Need to export error codes, and size of each object, in words! */
  13:Source/rme_benchmark.c **** /* End Include ***************************************************************/
  14:Source/rme_benchmark.c **** 
  15:Source/rme_benchmark.c **** /* Function:_RME_Tsc_Init *****************************************************
  16:Source/rme_benchmark.c **** Description : The initialization of timestamp counter. 19 secs before overflowing.
  17:Source/rme_benchmark.c **** Input       : None.
  18:Source/rme_benchmark.c **** Output      : None.
  19:Source/rme_benchmark.c **** Return      : None.
  20:Source/rme_benchmark.c **** ******************************************************************************/
  21:Source/rme_benchmark.c **** void _RME_Tsc_Init(void)
  22:Source/rme_benchmark.c **** {
 804              		.loc 1 22 1
 805              		.cfi_startproc
 806              		@ args = 0, pretend = 0, frame = 0
 807              		@ frame_needed = 1, uses_anonymous_args = 0
 808              		@ link register save eliminated.
 809 0000 04B02DE5 		str	fp, [sp, #-4]!
 810              		.cfi_def_cfa_offset 4
 811              		.cfi_offset 11, -4
 812 0004 00B08DE2 		add	fp, sp, #0
 813              		.cfi_def_cfa_register 11
  23:Source/rme_benchmark.c **** //    TIM_HandleTypeDef TIM2_Handle;
  24:Source/rme_benchmark.c **** //    
  25:Source/rme_benchmark.c **** //    /* Initialize timer 2 to run at the same speed as the CPU */
  26:Source/rme_benchmark.c **** //    TIM2_Handle.Instance=TIM2;
  27:Source/rme_benchmark.c **** //    TIM2_Handle.Init.Prescaler=0;
  28:Source/rme_benchmark.c **** //    TIM2_Handle.Init.CounterMode=TIM_COUNTERMODE_UP;
  29:Source/rme_benchmark.c **** //    TIM2_Handle.Init.Period=(ptr_t)(-1);
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 26


  30:Source/rme_benchmark.c **** //    TIM2_Handle.Init.ClockDivision=TIM_CLOCKDIVISION_DIV1;
  31:Source/rme_benchmark.c **** //    HAL_TIM_Base_Init(&TIM2_Handle);
  32:Source/rme_benchmark.c **** //    __HAL_RCC_TIM2_CLK_ENABLE();
  33:Source/rme_benchmark.c **** //    __HAL_TIM_ENABLE(&TIM2_Handle);
  34:Source/rme_benchmark.c **** }
 814              		.loc 1 34 1
 815 0008 00F020E3 		nop
 816 000c 00D08BE2 		add	sp, fp, #0
 817              		.cfi_def_cfa_register 13
 818              		@ sp needed
 819 0010 04B09DE4 		ldr	fp, [sp], #4
 820              		.cfi_restore 11
 821              		.cfi_def_cfa_offset 0
 822 0014 1EFF2FE1 		bx	lr
 823              		.cfi_endproc
 824              	.LFE13:
 826              		.section	.rodata
 827              		.align	2
 828              	.LC0:
 829 0000 0D0A2068 		.ascii	"\015\012 hello! this is thread \000"
 829      656C6C6F 
 829      21207468 
 829      69732069 
 829      73207468 
 830              		.section	.text.RME_Same_Prc_Thd_Switch_Test_Thd,"ax",%progbits
 831              		.align	2
 832              		.global	RME_Same_Prc_Thd_Switch_Test_Thd
 833              		.syntax unified
 834              		.arm
 836              	RME_Same_Prc_Thd_Switch_Test_Thd:
 837              	.LFB14:
  35:Source/rme_benchmark.c **** /* End Function:_RME_Tsc_Init ************************************************/
  36:Source/rme_benchmark.c **** 
  37:Source/rme_benchmark.c **** /* Function:RME_Same_Prc_Thd_Switch_Test_Thd *********************************
  38:Source/rme_benchmark.c **** Description : The thread for testing same-process thread switching performance.
  39:Source/rme_benchmark.c **** Input       : None.
  40:Source/rme_benchmark.c **** Output      : None.
  41:Source/rme_benchmark.c **** Return      : None.
  42:Source/rme_benchmark.c **** ******************************************************************************/
  43:Source/rme_benchmark.c **** void RME_Same_Prc_Thd_Switch_Test_Thd(ptr_t Param1)
  44:Source/rme_benchmark.c **** {
 838              		.loc 1 44 1
 839              		.cfi_startproc
 840              		@ args = 0, pretend = 0, frame = 16
 841              		@ frame_needed = 1, uses_anonymous_args = 0
 842 0000 00482DE9 		push	{fp, lr}
 843              		.cfi_def_cfa_offset 8
 844              		.cfi_offset 11, -8
 845              		.cfi_offset 14, -4
 846 0004 04B08DE2 		add	fp, sp, #4
 847              		.cfi_def_cfa 11, 4
 848 0008 10D04DE2 		sub	sp, sp, #16
 849 000c 10000BE5 		str	r0, [fp, #-16]
  45:Source/rme_benchmark.c ****     ret_t Retval;
  46:Source/rme_benchmark.c **** 
  47:Source/rme_benchmark.c ****     USR_DBG_S("\r\n hello! this is thread ");
 850              		.loc 1 47 5
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 27


 851 0010 000000E3 		movw	r0, #:lower16:.LC0
 852 0014 000040E3 		movt	r0, #:upper16:.LC0
 853 0018 FEFFFFEB 		bl	USR_DBG_S
  48:Source/rme_benchmark.c ****     USR_DBG_I(Param1);
 854              		.loc 1 48 5
 855 001c 10301BE5 		ldr	r3, [fp, #-16]
 856 0020 0300A0E1 		mov	r0, r3
 857 0024 FEFFFFEB 		bl	USR_DBG_I
 858              	.L51:
  49:Source/rme_benchmark.c ****     /* Now we switch back to the init thread, immediately */
  50:Source/rme_benchmark.c ****     while(1)
  51:Source/rme_benchmark.c ****     {
  52:Source/rme_benchmark.c ****         /*Retval=RME_CAP_OP(RME_SVC_THD_SWT,0,
  53:Source/rme_benchmark.c ****                           RME_BOOT_INIT_THD,
  54:Source/rme_benchmark.c ****                           0,
  55:Source/rme_benchmark.c ****                           0);*/
  56:Source/rme_benchmark.c ****         Retval=RME_Thd_Swt(RME_BOOT_INIT_THD,0);
 859              		.loc 1 56 16 discriminator 1
 860 0028 0010A0E3 		mov	r1, #0
 861 002c 0300A0E3 		mov	r0, #3
 862 0030 FEFFFFEB 		bl	RME_Thd_Swt
 863 0034 08000BE5 		str	r0, [fp, #-8]
 864              		.loc 1 56 15
 865 0038 FAFFFFEA 		b	.L51
 866              		.cfi_endproc
 867              	.LFE14:
 869              		.section	.rodata
 870 001a 0000     		.align	2
 871              	.LC1:
 872 001c 0D0A2F2A 		.ascii	"\015\012/****************\000"
 872      2A2A2A2A 
 872      2A2A2A2A 
 872      2A2A2A2A 
 872      2A2A2A00 
 873              		.align	2
 874              	.LC2:
 875 0030 62656769 		.ascii	"begin RME_Same_Prc_Thd_Switch_Test\000"
 875      6E20524D 
 875      455F5361 
 875      6D655F50 
 875      72635F54 
 876 0053 00       		.align	2
 877              	.LC3:
 878 0054 2A2A2A2A 		.ascii	"****************/\000"
 878      2A2A2A2A 
 878      2A2A2A2A 
 878      2A2A2A2A 
 878      2F00
 879 0066 0000     		.align	2
 880              	.LC4:
 881 0068 0D0A2870 		.ascii	"\015\012(ptr_t)(&RME_Stack[2047])= \000"
 881      74725F74 
 881      29282652 
 881      4D455F53 
 881      7461636B 
 882 0086 0000     		.align	2
 883              	.LC5:
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 28


 884 0088 0D0A496E 		.ascii	"\015\012Initialize the thread's stack Stack_Addr= \000"
 884      69746961 
 884      6C697A65 
 884      20746865 
 884      20746872 
 885 00b5 000000   		.align	2
 886              	.LC6:
 887 00b8 0D0A6372 		.ascii	"\015\012create a thread      retval= \000"
 887      65617465 
 887      20612074 
 887      68726561 
 887      64202020 
 888              		.align	2
 889              	.LC7:
 890 00d8 0D0A4269 		.ascii	"\015\012Bind the thread to the processor retval= \000"
 890      6E642074 
 890      68652074 
 890      68726561 
 890      6420746F 
 891              		.align	2
 892              	.LC8:
 893 0104 0D0A5365 		.ascii	"\015\012Set the execution information retval= \000"
 893      74207468 
 893      65206578 
 893      65637574 
 893      696F6E20 
 894 012d 000000   		.align	2
 895              	.LC9:
 896 0130 0D0A00   		.ascii	"\015\012\000"
 897 0133 00       		.align	2
 898              	.LC10:
 899 0134 0D0A4465 		.ascii	"\015\012Delegate some timeslice to it retval= \000"
 899      6C656761 
 899      74652073 
 899      6F6D6520 
 899      74696D65 
 900 015d 000000   		.align	2
 901              	.LC11:
 902 0160 0D0A5472 		.ascii	"\015\012Try to switch to that thread - should fail "
 902      7920746F 
 902      20737769 
 902      74636820 
 902      746F2074 
 903 018d 20726574 		.ascii	" retval= \000"
 903      76616C3D 
 903      2000
 904 0197 00       		.align	2
 905              	.LC12:
 906 0198 0D0A5472 		.ascii	"\015\012Try to switch to that thread  retval= \000"
 906      7920746F 
 906      20737769 
 906      74636820 
 906      746F2074 
 907              		.section	.text.RME_Same_Prc_Thd_Switch_Test,"ax",%progbits
 908              		.align	2
 909              		.global	RME_Same_Prc_Thd_Switch_Test
 910              		.syntax unified
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 29


 911              		.arm
 913              	RME_Same_Prc_Thd_Switch_Test:
 914              	.LFB15:
  57:Source/rme_benchmark.c ****     }
  58:Source/rme_benchmark.c **** }
  59:Source/rme_benchmark.c **** /* End Function:RME_Same_Prc_Thd_Switch_Test_Thd ****************************/
  60:Source/rme_benchmark.c **** 
  61:Source/rme_benchmark.c **** /* Function:RME_Same_Prc_Thd_Switch_Test *************************************
  62:Source/rme_benchmark.c **** Description : The same-process thread switch test code.
  63:Source/rme_benchmark.c **** Input       : None.
  64:Source/rme_benchmark.c **** Output      : None.
  65:Source/rme_benchmark.c **** Return      : None.
  66:Source/rme_benchmark.c **** ******************************************************************************/
  67:Source/rme_benchmark.c **** void RME_Same_Prc_Thd_Switch_Test(void)
  68:Source/rme_benchmark.c **** {
 915              		.loc 1 68 1
 916              		.cfi_startproc
 917              		@ args = 0, pretend = 0, frame = 16
 918              		@ frame_needed = 1, uses_anonymous_args = 0
 919 0000 00482DE9 		push	{fp, lr}
 920              		.cfi_def_cfa_offset 8
 921              		.cfi_offset 11, -8
 922              		.cfi_offset 14, -4
 923 0004 04B08DE2 		add	fp, sp, #4
 924              		.cfi_def_cfa 11, 4
 925 0008 20D04DE2 		sub	sp, sp, #32
  69:Source/rme_benchmark.c **** 	USR_DBG_S("\r\n/****************");
 926              		.loc 1 69 2
 927 000c 000000E3 		movw	r0, #:lower16:.LC1
 928 0010 000040E3 		movt	r0, #:upper16:.LC1
 929 0014 FEFFFFEB 		bl	USR_DBG_S
  70:Source/rme_benchmark.c **** 	USR_DBG_S("begin RME_Same_Prc_Thd_Switch_Test");
 930              		.loc 1 70 2
 931 0018 000000E3 		movw	r0, #:lower16:.LC2
 932 001c 000040E3 		movt	r0, #:upper16:.LC2
 933 0020 FEFFFFEB 		bl	USR_DBG_S
  71:Source/rme_benchmark.c **** 	USR_DBG_S("****************/");
 934              		.loc 1 71 2
 935 0024 000000E3 		movw	r0, #:lower16:.LC3
 936 0028 000040E3 		movt	r0, #:upper16:.LC3
 937 002c FEFFFFEB 		bl	USR_DBG_S
  72:Source/rme_benchmark.c ****     /* Intra-process thread switching time */
  73:Source/rme_benchmark.c ****     ret_t Retval;
  74:Source/rme_benchmark.c ****     cnt_t Count;
  75:Source/rme_benchmark.c ****     ptr_t Stack_Addr;
  76:Source/rme_benchmark.c ****     ptr_t Temp;
  77:Source/rme_benchmark.c ****     /* Initialize the thread's stack before entering it */
  78:Source/rme_benchmark.c ****     Stack_Addr=(ptr_t)&RME_Stack[2000];/* _RME_Stack_Init((ptr_t)(&RME_Stack[2047]),
 938              		.loc 1 78 15
 939 0030 70319FE5 		ldr	r3, .L56
 940 0034 0C300BE5 		str	r3, [fp, #-12]
  79:Source/rme_benchmark.c ****                                (ptr_t)RME_Thd_Stub,
  80:Source/rme_benchmark.c ****                                1, 2, 3, 4); */
  81:Source/rme_benchmark.c **** 
  82:Source/rme_benchmark.c ****     USR_DBG_S("\r\n(ptr_t)(&RME_Stack[2047])= ");
 941              		.loc 1 82 5
 942 0038 000000E3 		movw	r0, #:lower16:.LC4
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 30


 943 003c 000040E3 		movt	r0, #:upper16:.LC4
 944 0040 FEFFFFEB 		bl	USR_DBG_S
  83:Source/rme_benchmark.c ****     USR_DBG_H((ptr_t)(&RME_Stack[2047]));
 945              		.loc 1 83 5
 946 0044 60319FE5 		ldr	r3, .L56+4
 947 0048 0300A0E1 		mov	r0, r3
 948 004c FEFFFFEB 		bl	USR_DBG_H
  84:Source/rme_benchmark.c ****     USR_DBG_S("\r\nInitialize the thread's stack Stack_Addr= ");
 949              		.loc 1 84 5
 950 0050 000000E3 		movw	r0, #:lower16:.LC5
 951 0054 000040E3 		movt	r0, #:upper16:.LC5
 952 0058 FEFFFFEB 		bl	USR_DBG_S
  85:Source/rme_benchmark.c ****     USR_DBG_H(Stack_Addr);
 953              		.loc 1 85 5
 954 005c 0C001BE5 		ldr	r0, [fp, #-12]
 955 0060 FEFFFFEB 		bl	USR_DBG_H
  86:Source/rme_benchmark.c **** 
  87:Source/rme_benchmark.c ****     /* There are still many bugs in the kernel. Need a white-box test to guarantee
  88:Source/rme_benchmark.c ****      * that it is free of bugs. Find a scheme to do that */
  89:Source/rme_benchmark.c ****     /*Retval=RME_CAP_OP(RME_SVC_THD_CRT,RME_BOOT_INIT_CPT,
  90:Source/rme_benchmark.c ****                       RME_PARAM_D1(RME_BOOT_INIT_KOM)|RME_PARAM_D0(RME_BOOT_BENCH_THD),
  91:Source/rme_benchmark.c ****                       RME_PARAM_D1(RME_BOOT_INIT_PRC)|RME_PARAM_D0(31),
  92:Source/rme_benchmark.c ****                       RME_BOOT_BENCH_KOM_FRONTIER);*/
  93:Source/rme_benchmark.c ****     Retval=RME_Thd_Crt(RME_BOOT_INIT_CPT,RME_BOOT_INIT_KOM,RME_BOOT_BENCH_THD,
 956              		.loc 1 93 12
 957 0064 0030A0E3 		mov	r3, #0
 958 0068 08308DE5 		str	r3, [sp, #8]
 959 006c 093AA0E3 		mov	r3, #36864
 960 0070 04308DE5 		str	r3, [sp, #4]
 961 0074 1F30A0E3 		mov	r3, #31
 962 0078 00308DE5 		str	r3, [sp]
 963 007c 0230A0E3 		mov	r3, #2
 964 0080 0820A0E3 		mov	r2, #8
 965 0084 0510A0E3 		mov	r1, #5
 966 0088 0000A0E3 		mov	r0, #0
 967 008c FEFFFFEB 		bl	RME_Thd_Crt
 968 0090 10000BE5 		str	r0, [fp, #-16]
  94:Source/rme_benchmark.c ****                        RME_BOOT_INIT_PRC,RME_THD_PRIO_MAX,RME_BOOT_BENCH_KOM_FRONTIER,0);
  95:Source/rme_benchmark.c ****     USR_DBG_S("\r\ncreate a thread      retval= ");
 969              		.loc 1 95 5
 970 0094 000000E3 		movw	r0, #:lower16:.LC6
 971 0098 000040E3 		movt	r0, #:upper16:.LC6
 972 009c FEFFFFEB 		bl	USR_DBG_S
  96:Source/rme_benchmark.c ****     USR_DBG_I(Retval);
 973              		.loc 1 96 5
 974 00a0 10001BE5 		ldr	r0, [fp, #-16]
 975 00a4 FEFFFFEB 		bl	USR_DBG_I
  97:Source/rme_benchmark.c **** 
  98:Source/rme_benchmark.c ****     /* Bind the thread to the processor */
  99:Source/rme_benchmark.c ****     /*Retval=RME_CAP_OP(RME_SVC_THD_SCHED_BIND,RME_BOOT_BENCH_THD,
 100:Source/rme_benchmark.c ****     		          RME_PARAM_D1(RME_BOOT_INIT_THD)|RME_PARAM_D0(RME_CID_NULL),
 101:Source/rme_benchmark.c **** 					  RME_PARAM_D1(RME_TID_2)|RME_PARAM_D0(RME_BOOT_INIT_PRC),
 102:Source/rme_benchmark.c **** 					  RME_BOOT_HYPER_KOM_VADDR);*/
 103:Source/rme_benchmark.c ****     Retval=RME_Thd_Sched_Bind(RME_BOOT_BENCH_THD,RME_BOOT_INIT_THD,RME_CID_NULL,
 976              		.loc 1 103 12
 977 00a8 0030A0E3 		mov	r3, #0
 978 00ac 04308DE5 		str	r3, [sp, #4]
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 31


 979 00b0 0030A0E3 		mov	r3, #0
 980 00b4 00308DE5 		str	r3, [sp]
 981 00b8 0230A0E3 		mov	r3, #2
 982 00bc 0229A0E3 		mov	r2, #32768
 983 00c0 0310A0E3 		mov	r1, #3
 984 00c4 0800A0E3 		mov	r0, #8
 985 00c8 FEFFFFEB 		bl	RME_Thd_Sched_Bind
 986 00cc 10000BE5 		str	r0, [fp, #-16]
 104:Source/rme_benchmark.c ****                               RME_TID_2,0,RME_BOOT_HYPER_KOM_VADDR);
 105:Source/rme_benchmark.c ****     USR_DBG_S("\r\nBind the thread to the processor retval= ");
 987              		.loc 1 105 5
 988 00d0 000000E3 		movw	r0, #:lower16:.LC7
 989 00d4 000040E3 		movt	r0, #:upper16:.LC7
 990 00d8 FEFFFFEB 		bl	USR_DBG_S
 106:Source/rme_benchmark.c ****     USR_DBG_I(Retval);
 991              		.loc 1 106 5
 992 00dc 10001BE5 		ldr	r0, [fp, #-16]
 993 00e0 FEFFFFEB 		bl	USR_DBG_I
 107:Source/rme_benchmark.c ****     extern void RME_Deadloop(void);
 108:Source/rme_benchmark.c ****     /* Set the execution information */
 109:Source/rme_benchmark.c ****     /*Retval=RME_CAP_OP(RME_SVC_THD_EXEC_SET,RME_BOOT_BENCH_THD,
 110:Source/rme_benchmark.c **** 	         	 	 (ptr_t)RME_Same_Prc_Thd_Switch_Test_Thd,
 111:Source/rme_benchmark.c ****     		         //(ptr_t)RME_Deadloop,
 112:Source/rme_benchmark.c **** 					 Stack_Addr,RME_TID_2);*/
 113:Source/rme_benchmark.c ****     Retval=RME_Thd_Exec_Set(RME_BOOT_BENCH_THD,(ptr_t)RME_Same_Prc_Thd_Switch_Test_Thd,Stack_Addr,R
 994              		.loc 1 113 12
 995 00e4 001000E3 		movw	r1, #:lower16:RME_Same_Prc_Thd_Switch_Test_Thd
 996 00e8 001040E3 		movt	r1, #:upper16:RME_Same_Prc_Thd_Switch_Test_Thd
 997 00ec 0230A0E3 		mov	r3, #2
 998 00f0 0C201BE5 		ldr	r2, [fp, #-12]
 999 00f4 0800A0E3 		mov	r0, #8
 1000 00f8 FEFFFFEB 		bl	RME_Thd_Exec_Set
 1001 00fc 10000BE5 		str	r0, [fp, #-16]
 114:Source/rme_benchmark.c ****     //RME_Stack[2000]=1234;
 115:Source/rme_benchmark.c ****     USR_DBG_S("\r\nSet the execution information retval= ");
 1002              		.loc 1 115 5
 1003 0100 000000E3 		movw	r0, #:lower16:.LC8
 1004 0104 000040E3 		movt	r0, #:upper16:.LC8
 1005 0108 FEFFFFEB 		bl	USR_DBG_S
 116:Source/rme_benchmark.c ****     USR_DBG_I(Retval);
 1006              		.loc 1 116 5
 1007 010c 10001BE5 		ldr	r0, [fp, #-16]
 1008 0110 FEFFFFEB 		bl	USR_DBG_I
 117:Source/rme_benchmark.c ****     USR_DBG_S("\r\n");
 1009              		.loc 1 117 5
 1010 0114 000000E3 		movw	r0, #:lower16:.LC9
 1011 0118 000040E3 		movt	r0, #:upper16:.LC9
 1012 011c FEFFFFEB 		bl	USR_DBG_S
 118:Source/rme_benchmark.c ****     /* Delegate some timeslice to it */
 119:Source/rme_benchmark.c ****     /*Retval=RME_CAP_OP(RME_SVC_THD_TIME_XFER,RME_BOOT_BENCH_THD,
 120:Source/rme_benchmark.c ****                       RME_BOOT_BENCH_THD,
 121:Source/rme_benchmark.c ****                       RME_BOOT_INIT_THD,
 122:Source/rme_benchmark.c ****                       10000000);*/
 123:Source/rme_benchmark.c ****     Retval=RME_Thd_Time_Xfer(RME_BOOT_BENCH_THD,RME_BOOT_INIT_THD,RME_THD_INF_TIME);
 1013              		.loc 1 123 12
 1014 0120 0621E0E3 		mvn	r2, #-2147483647
 1015 0124 0310A0E3 		mov	r1, #3
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 32


 1016 0128 0800A0E3 		mov	r0, #8
 1017 012c FEFFFFEB 		bl	RME_Thd_Time_Xfer
 1018 0130 10000BE5 		str	r0, [fp, #-16]
 124:Source/rme_benchmark.c **** 
 125:Source/rme_benchmark.c ****     //Retval=RME_Thd_Time_Xfer(RME_BOOT_BENCH_THD,RME_BOOT_INIT_THD,1000);
 126:Source/rme_benchmark.c ****     USR_DBG_S("\r\nDelegate some timeslice to it retval= ");
 1019              		.loc 1 126 5
 1020 0134 000000E3 		movw	r0, #:lower16:.LC10
 1021 0138 000040E3 		movt	r0, #:upper16:.LC10
 1022 013c FEFFFFEB 		bl	USR_DBG_S
 127:Source/rme_benchmark.c ****          USR_DBG_I(Retval);
 1023              		.loc 1 127 10
 1024 0140 10001BE5 		ldr	r0, [fp, #-16]
 1025 0144 FEFFFFEB 		bl	USR_DBG_I
 128:Source/rme_benchmark.c **** 
 129:Source/rme_benchmark.c ****     Retval=RME_Thd_Swt(RME_BOOT_BENCH_THD,0);
 1026              		.loc 1 129 12
 1027 0148 0010A0E3 		mov	r1, #0
 1028 014c 0800A0E3 		mov	r0, #8
 1029 0150 FEFFFFEB 		bl	RME_Thd_Swt
 1030 0154 10000BE5 		str	r0, [fp, #-16]
 130:Source/rme_benchmark.c ****     USR_DBG_S("\r\nTry to switch to that thread - should fail  retval= ");
 1031              		.loc 1 130 5
 1032 0158 000000E3 		movw	r0, #:lower16:.LC11
 1033 015c 000040E3 		movt	r0, #:upper16:.LC11
 1034 0160 FEFFFFEB 		bl	USR_DBG_S
 131:Source/rme_benchmark.c ****     USR_DBG_I(Retval);
 1035              		.loc 1 131 5
 1036 0164 10001BE5 		ldr	r0, [fp, #-16]
 1037 0168 FEFFFFEB 		bl	USR_DBG_I
 132:Source/rme_benchmark.c ****     /* Test result: intra-process ctxsw 358cycles/1.657us, frt w/mpu 163cycles/0.754us,
 133:Source/rme_benchmark.c ****     * composite 324. opted max:323
 134:Source/rme_benchmark.c ****     * all:33.0
 135:Source/rme_benchmark.c ****     * empty: 4.09 - 0.409us, most time spent on internals
 136:Source/rme_benchmark.c ****     * w/selections: 7.15 - maybe no need to check frozen cap from the proc.
 137:Source/rme_benchmark.c ****     * w/checkings:10.926 - 317us.
 138:Source/rme_benchmark.c ****     * total:16.57
 139:Source/rme_benchmark.c ****     * 16.2us now, after cleaning up two bad things
 140:Source/rme_benchmark.c ****     * 14.7us after CPUID optimizations. The quiescence hardly worked.
 141:Source/rme_benchmark.c ****     * no cache - 3 times slower, mainly due to the flash. ART does not really help.
 142:Source/rme_benchmark.c ****     * Performance cannot be further optimized anymore without compiler intrinsics.
 143:Source/rme_benchmark.c ****     * Something terribly wrong with systick. 38 second wrapwround
 144:Source/rme_benchmark.c ****     * This configuration, CPU works at 216MHz, correct, but the 
 145:Source/rme_benchmark.c ****     * The TSC is always 8 cycles between reads.
 146:Source/rme_benchmark.c ****     */
 147:Source/rme_benchmark.c ****     //_RME_Tsc_Init();
 148:Source/rme_benchmark.c ****     //for(Count=0;Count<10000;Count++)
 149:Source/rme_benchmark.c ****     for(Count=0;Count<10;Count++)
 1038              		.loc 1 149 14
 1039 016c 0030A0E3 		mov	r3, #0
 1040 0170 08300BE5 		str	r3, [fp, #-8]
 1041              		.loc 1 149 5
 1042 0174 070000EA 		b	.L53
 1043              	.L54:
 150:Source/rme_benchmark.c ****     {
 151:Source/rme_benchmark.c ****         //Temp=RME_TSC();
 152:Source/rme_benchmark.c ****         /*Retval=RME_CAP_OP(RME_SVC_THD_SWT,0,
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 33


 153:Source/rme_benchmark.c ****                           RME_BOOT_BENCH_THD,
 154:Source/rme_benchmark.c ****                           0,
 155:Source/rme_benchmark.c ****                           0);*/
 156:Source/rme_benchmark.c ****         //Retval=RME_Thd_Swt(RME_BOOT_BENCH_THD,0);
 157:Source/rme_benchmark.c ****         //Temp=RME_TSC()-Temp;
 158:Source/rme_benchmark.c ****        // Time[Count]=Temp-8;
 159:Source/rme_benchmark.c ****         USR_DBG_S("\r\nTry to switch to that thread  retval= ");
 1044              		.loc 1 159 9
 1045 0178 000000E3 		movw	r0, #:lower16:.LC12
 1046 017c 000040E3 		movt	r0, #:upper16:.LC12
 1047 0180 FEFFFFEB 		bl	USR_DBG_S
 160:Source/rme_benchmark.c ****         USR_DBG_I(Retval);
 1048              		.loc 1 160 9
 1049 0184 10001BE5 		ldr	r0, [fp, #-16]
 1050 0188 FEFFFFEB 		bl	USR_DBG_I
 149:Source/rme_benchmark.c ****     {
 1051              		.loc 1 149 31 discriminator 3
 1052 018c 08301BE5 		ldr	r3, [fp, #-8]
 1053 0190 013083E2 		add	r3, r3, #1
 1054 0194 08300BE5 		str	r3, [fp, #-8]
 1055              	.L53:
 149:Source/rme_benchmark.c ****     {
 1056              		.loc 1 149 22 discriminator 1
 1057 0198 08301BE5 		ldr	r3, [fp, #-8]
 1058 019c 090053E3 		cmp	r3, #9
 1059 01a0 F4FFFFDA 		ble	.L54
 1060              	.L55:
 161:Source/rme_benchmark.c ****     }
 162:Source/rme_benchmark.c ****     
 163:Source/rme_benchmark.c ****     // test sig_snd/sig_rcv
 164:Source/rme_benchmark.c **** 
 165:Source/rme_benchmark.c **** 
 166:Source/rme_benchmark.c **** 
 167:Source/rme_benchmark.c ****     while(1);
 1061              		.loc 1 167 10
 1062 01a4 FEFFFFEA 		b	.L55
 1063              	.L57:
 1064              		.align	2
 1065              	.L56:
 1066 01a8 401F0000 		.word	RME_Stack+8000
 1067 01ac FC1F0000 		.word	RME_Stack+8188
 1068              		.cfi_endproc
 1069              	.LFE15:
 1071              		.section	.text.RME_Diff_Prc_Thd_Switch_Test_Thd,"ax",%progbits
 1072              		.align	2
 1073              		.global	RME_Diff_Prc_Thd_Switch_Test_Thd
 1074              		.syntax unified
 1075              		.arm
 1077              	RME_Diff_Prc_Thd_Switch_Test_Thd:
 1078              	.LFB16:
 168:Source/rme_benchmark.c **** }
 169:Source/rme_benchmark.c **** /* End Function:RME_Same_Prc_Thd_Switch_Test ********************************/
 170:Source/rme_benchmark.c **** 
 171:Source/rme_benchmark.c **** /* Function:RME_Diff_Prc_Thd_Switch_Test_Thd *********************************
 172:Source/rme_benchmark.c **** Description : The thread for testing same-process thread switching performance.
 173:Source/rme_benchmark.c **** Input       : None.
 174:Source/rme_benchmark.c **** Output      : None.
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 34


 175:Source/rme_benchmark.c **** Return      : None.
 176:Source/rme_benchmark.c **** ******************************************************************************/
 177:Source/rme_benchmark.c **** void RME_Diff_Prc_Thd_Switch_Test_Thd(ptr_t Param1, ptr_t Param2, ptr_t Param3, ptr_t Param4)
 178:Source/rme_benchmark.c **** {
 1079              		.loc 1 178 1
 1080              		.cfi_startproc
 1081              		@ args = 0, pretend = 0, frame = 24
 1082              		@ frame_needed = 1, uses_anonymous_args = 0
 1083 0000 00482DE9 		push	{fp, lr}
 1084              		.cfi_def_cfa_offset 8
 1085              		.cfi_offset 11, -8
 1086              		.cfi_offset 14, -4
 1087 0004 04B08DE2 		add	fp, sp, #4
 1088              		.cfi_def_cfa 11, 4
 1089 0008 18D04DE2 		sub	sp, sp, #24
 1090 000c 10000BE5 		str	r0, [fp, #-16]
 1091 0010 14100BE5 		str	r1, [fp, #-20]
 1092 0014 18200BE5 		str	r2, [fp, #-24]
 1093 0018 1C300BE5 		str	r3, [fp, #-28]
 1094              	.L59:
 179:Source/rme_benchmark.c ****     ret_t Retval;
 180:Source/rme_benchmark.c ****     /* Now we switch back to the init thread, immediately */
 181:Source/rme_benchmark.c ****     while(1)
 182:Source/rme_benchmark.c ****     {
 183:Source/rme_benchmark.c ****         /*Retval=RME_CAP_OP(RME_SVC_THD_SWT,0,
 184:Source/rme_benchmark.c ****                           RME_BOOT_INIT_THD,
 185:Source/rme_benchmark.c ****                           0,
 186:Source/rme_benchmark.c ****                           0);*/
 187:Source/rme_benchmark.c ****         Retval=RME_Thd_Swt(RME_BOOT_INIT_THD,0);
 1095              		.loc 1 187 16 discriminator 1
 1096 001c 0010A0E3 		mov	r1, #0
 1097 0020 0300A0E3 		mov	r0, #3
 1098 0024 FEFFFFEB 		bl	RME_Thd_Swt
 1099 0028 08000BE5 		str	r0, [fp, #-8]
 1100              		.loc 1 187 15
 1101 002c FAFFFFEA 		b	.L59
 1102              		.cfi_endproc
 1103              	.LFE16:
 1105              		.section	.text.RME_Diff_Prc_Thd_Switch_Test,"ax",%progbits
 1106              		.align	2
 1107              		.global	RME_Diff_Prc_Thd_Switch_Test
 1108              		.syntax unified
 1109              		.arm
 1111              	RME_Diff_Prc_Thd_Switch_Test:
 1112              	.LFB17:
 188:Source/rme_benchmark.c ****     }
 189:Source/rme_benchmark.c **** }
 190:Source/rme_benchmark.c **** /* End Function:RME_Diff_Prc_Thd_Switch_Test_Thd ****************************/
 191:Source/rme_benchmark.c **** 
 192:Source/rme_benchmark.c **** /* Function:RME_Diff_Prc_Thd_Switch_Test *************************************
 193:Source/rme_benchmark.c **** Description : The same-process thread switch test code.
 194:Source/rme_benchmark.c **** Input       : None.
 195:Source/rme_benchmark.c **** Output      : None.
 196:Source/rme_benchmark.c **** Return      : None.
 197:Source/rme_benchmark.c **** ******************************************************************************/
 198:Source/rme_benchmark.c **** void RME_Diff_Prc_Thd_Switch_Test(void)
 199:Source/rme_benchmark.c **** {
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 35


 1113              		.loc 1 199 1
 1114              		.cfi_startproc
 1115              		@ args = 0, pretend = 0, frame = 16
 1116              		@ frame_needed = 1, uses_anonymous_args = 0
 1117 0000 00482DE9 		push	{fp, lr}
 1118              		.cfi_def_cfa_offset 8
 1119              		.cfi_offset 11, -8
 1120              		.cfi_offset 14, -4
 1121 0004 04B08DE2 		add	fp, sp, #4
 1122              		.cfi_def_cfa 11, 4
 1123 0008 18D04DE2 		sub	sp, sp, #24
 200:Source/rme_benchmark.c ****     /* Intra-process thread switching time */
 201:Source/rme_benchmark.c ****     ret_t Retval;
 202:Source/rme_benchmark.c ****     cnt_t Count;
 203:Source/rme_benchmark.c ****     ptr_t Stack_Addr;
 204:Source/rme_benchmark.c ****     ptr_t Temp;
 205:Source/rme_benchmark.c ****     ptr_t Frontier;
 206:Source/rme_benchmark.c ****     
 207:Source/rme_benchmark.c ****     Frontier=RME_BOOT_BENCH_KOM_FRONTIER;
 1124              		.loc 1 207 13
 1125 000c 093AA0E3 		mov	r3, #36864
 1126 0010 0C300BE5 		str	r3, [fp, #-12]
 208:Source/rme_benchmark.c ****     /* Initialize the thread's stack before entering it */
 209:Source/rme_benchmark.c ****     Stack_Addr=_RME_Stack_Init((ptr_t)(&RME_Stack[2047]),
 1127              		.loc 1 209 16
 1128 0014 54009FE5 		ldr	r0, .L64
 1129 0018 001000E3 		movw	r1, #:lower16:RME_Thd_Stub
 1130 001c 001040E3 		movt	r1, #:upper16:RME_Thd_Stub
 1131 0020 0430A0E3 		mov	r3, #4
 1132 0024 04308DE5 		str	r3, [sp, #4]
 1133 0028 0330A0E3 		mov	r3, #3
 1134 002c 00308DE5 		str	r3, [sp]
 1135 0030 0230A0E3 		mov	r3, #2
 1136 0034 0120A0E3 		mov	r2, #1
 1137 0038 FEFFFFEB 		bl	_RME_Stack_Init
 1138 003c 10000BE5 		str	r0, [fp, #-16]
 210:Source/rme_benchmark.c ****                                (ptr_t)RME_Thd_Stub,
 211:Source/rme_benchmark.c ****                                1, 2, 3, 4);
 212:Source/rme_benchmark.c ****     
 213:Source/rme_benchmark.c ****     /* Create the page table for the whole address space range */
 214:Source/rme_benchmark.c ****     /*Retval=RME_CAP_OP(RME_SVC_PGT_CRT,RME_BOOT_INIT_CPT,
 215:Source/rme_benchmark.c ****                       RME_PARAM_D1(RME_BOOT_INIT_KOM)|RME_PARAM_Q1(RME_BOOT_BENCH_PGT_TOP)|
 216:Source/rme_benchmark.c ****                       RME_PARAM_O1(29)|RME_PARAM_O0(3),
 217:Source/rme_benchmark.c ****                       Frontier,
 218:Source/rme_benchmark.c ****                       1);*/
 219:Source/rme_benchmark.c **** //    Frontier+=;
 220:Source/rme_benchmark.c **** //    /* Create the page table for the SRAM range */
 221:Source/rme_benchmark.c **** //    Retval=RME_CAP_OP(RME_SVC_PGT_CRT,RME_BOOT_INIT_CPT,
 222:Source/rme_benchmark.c **** //                      RME_PARAM_D1(RME_BOOT_INIT_KOM)|RME_PARAM_Q1(RME_BOOT_BENCH_PGT_SRAM)|
 223:Source/rme_benchmark.c **** //                      RME_PARAM_O1(16)|RME_PARAM_O0(3),
 224:Source/rme_benchmark.c **** //                      Frontier,
 225:Source/rme_benchmark.c **** //                      0x20000001);*/
 226:Source/rme_benchmark.c **** //    Frontier+=;
 227:Source/rme_benchmark.c **** //    /* Map the pages into the top-level and the second-level */
 228:Source/rme_benchmark.c **** //    RME_CAP_OP(RME_SVC_PGT_ADD,0,
 229:Source/rme_benchmark.c **** //               RME_PARAM_Q1(RME_BOOT_BENCH_PGT_TOP)|0,
 230:Source/rme_benchmark.c **** //               RME_PARAM_D1(RME_BOOT_INIT_PGT)|0,
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 36


 231:Source/rme_benchmark.c **** //               |0)*/
 232:Source/rme_benchmark.c ****                       
 233:Source/rme_benchmark.c ****                   
 234:Source/rme_benchmark.c ****     
 235:Source/rme_benchmark.c ****     
 236:Source/rme_benchmark.c ****     
 237:Source/rme_benchmark.c ****     /*Retval=RME_CAP_OP(RME_SVC_THD_CRT,RME_BOOT_INIT_CPT,
 238:Source/rme_benchmark.c ****                       RME_PARAM_D1(RME_BOOT_INIT_KOM)|RME_PARAM_D0(RME_BOOT_BENCH_THD),
 239:Source/rme_benchmark.c ****                       RME_PARAM_D1(RME_BOOT_INIT_PRC)|RME_PARAM_D0(31),
 240:Source/rme_benchmark.c ****                       RME_BOOT_BENCH_KOM_FRONTIER);*/
 241:Source/rme_benchmark.c ****     
 242:Source/rme_benchmark.c ****     /* Bind the thread to the processor */
 243:Source/rme_benchmark.c ****     /*Retval=RME_CAP_OP(RME_SVC_THD_SCHED_BIND,0,
 244:Source/rme_benchmark.c ****                       RME_BOOT_BENCH_THD,
 245:Source/rme_benchmark.c ****                       RME_BOOT_INIT_THD,
 246:Source/rme_benchmark.c ****                       0);*/
 247:Source/rme_benchmark.c ****     
 248:Source/rme_benchmark.c ****     /* Set the execution information */
 249:Source/rme_benchmark.c ****     /*Retval=RME_CAP_OP(RME_SVC_THD_EXEC_SET,0,
 250:Source/rme_benchmark.c ****                       RME_BOOT_BENCH_THD,
 251:Source/rme_benchmark.c ****                       (ptr_t)RME_Same_Prc_Thd_Switch_Test_Thd,
 252:Source/rme_benchmark.c ****                       Stack_Addr);*/
 253:Source/rme_benchmark.c ****                       
 254:Source/rme_benchmark.c ****     /* Delegate some timeslice to it */
 255:Source/rme_benchmark.c ****     /*Retval=RME_CAP_OP(RME_SVC_THD_TIME_XFER,0,
 256:Source/rme_benchmark.c ****                       RME_BOOT_BENCH_THD,
 257:Source/rme_benchmark.c ****                       RME_BOOT_INIT_THD,
 258:Source/rme_benchmark.c ****                       10000000);*/
 259:Source/rme_benchmark.c ****     
 260:Source/rme_benchmark.c ****     /* Try to switch to that thread - should fail */
 261:Source/rme_benchmark.c ****     /*Retval=RME_CAP_OP(RME_SVC_THD_SWT,0,
 262:Source/rme_benchmark.c ****                       RME_BOOT_BENCH_THD,
 263:Source/rme_benchmark.c ****                       0,
 264:Source/rme_benchmark.c ****                       0);*/
 265:Source/rme_benchmark.c ****     /* Test result: intra-process ctxsw 358cycles/1.657us, frt w/mpu 163cycles/0.754us,
 266:Source/rme_benchmark.c ****     * composite 324. opted max:323
 267:Source/rme_benchmark.c ****     * all:33.0
 268:Source/rme_benchmark.c ****     * empty: 4.09 - 0.409us, most time spent on internals
 269:Source/rme_benchmark.c ****     * w/selections: 7.15 - maybe no need to check frozen cap from the proc.
 270:Source/rme_benchmark.c ****     * w/checkings:10.926 - 317us.
 271:Source/rme_benchmark.c ****     * total:16.57
 272:Source/rme_benchmark.c ****     * 16.2us now, after cleaning up two bad things
 273:Source/rme_benchmark.c ****     * 14.7us after CPUID optimizations. The quiescence hardly worked.
 274:Source/rme_benchmark.c ****     * no cache - 3 times slower, mainly due to the flash. ART does not really help.
 275:Source/rme_benchmark.c ****     * Performance cannot be further optimized anymore without compiler intrinsics.
 276:Source/rme_benchmark.c ****     * Something terribly wrong with systick. 38 second wrapwround
 277:Source/rme_benchmark.c ****     * This configuration, CPU works at 216MHz, correct, but the 
 278:Source/rme_benchmark.c ****     * The TSC is always 8 cycles between reads.
 279:Source/rme_benchmark.c ****     */
 280:Source/rme_benchmark.c ****     _RME_Tsc_Init();
 1139              		.loc 1 280 5
 1140 0040 FEFFFFEB 		bl	_RME_Tsc_Init
 281:Source/rme_benchmark.c ****     for(Count=0;Count<10000;Count++)
 1141              		.loc 1 281 14
 1142 0044 0030A0E3 		mov	r3, #0
 1143 0048 08300BE5 		str	r3, [fp, #-8]
 1144              		.loc 1 281 5
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 37


 1145 004c 020000EA 		b	.L61
 1146              	.L62:
 1147              		.loc 1 281 34 discriminator 3
 1148 0050 08301BE5 		ldr	r3, [fp, #-8]
 1149 0054 013083E2 		add	r3, r3, #1
 1150 0058 08300BE5 		str	r3, [fp, #-8]
 1151              	.L61:
 1152              		.loc 1 281 22 discriminator 1
 1153 005c 08301BE5 		ldr	r3, [fp, #-8]
 1154 0060 0F2702E3 		movw	r2, #9999
 1155 0064 020053E1 		cmp	r3, r2
 1156 0068 F8FFFFDA 		ble	.L62
 1157              	.L63:
 282:Source/rme_benchmark.c ****     {
 283:Source/rme_benchmark.c ****         //Temp=RME_TSC();
 284:Source/rme_benchmark.c ****         /*Retval=RME_CAP_OP(RME_SVC_THD_SWT,0,
 285:Source/rme_benchmark.c ****                           RME_BOOT_BENCH_THD,
 286:Source/rme_benchmark.c ****                           0,
 287:Source/rme_benchmark.c ****                           0);*/
 288:Source/rme_benchmark.c ****         //Temp=RME_TSC()-Temp;
 289:Source/rme_benchmark.c ****         //Time[Count]=Temp-8;
 290:Source/rme_benchmark.c ****     }
 291:Source/rme_benchmark.c ****     
 292:Source/rme_benchmark.c ****     while(1);
 1158              		.loc 1 292 10
 1159 006c FEFFFFEA 		b	.L63
 1160              	.L65:
 1161              		.align	2
 1162              	.L64:
 1163 0070 FC1F0000 		.word	RME_Stack+8188
 1164              		.cfi_endproc
 1165              	.LFE17:
 1167              		.section	.rodata
 1168 01c1 000000   		.align	2
 1169              	.LC13:
 1170 01c4 0D0A6265 		.ascii	"\015\012begin test \000"
 1170      67696E20 
 1170      74657374 
 1170      2000
 1171              		.section	.text.RME_Benchmark,"ax",%progbits
 1172              		.align	2
 1173              		.global	RME_Benchmark
 1174              		.syntax unified
 1175              		.arm
 1177              	RME_Benchmark:
 1178              	.LFB18:
 293:Source/rme_benchmark.c **** }
 294:Source/rme_benchmark.c **** /* End Function:RME_Diff_Prc_Thd_Switch_Test ********************************/
 295:Source/rme_benchmark.c **** 
 296:Source/rme_benchmark.c **** /* Function:RME_Benchmark *****************************************************
 297:Source/rme_benchmark.c **** Description : The benchmark entry, also the init thread.
 298:Source/rme_benchmark.c **** Input       : None.
 299:Source/rme_benchmark.c **** Output      : None.
 300:Source/rme_benchmark.c **** Return      : None.
 301:Source/rme_benchmark.c **** ******************************************************************************/
 302:Source/rme_benchmark.c **** void RME_Benchmark(void)
 303:Source/rme_benchmark.c **** {
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 38


 1179              		.loc 1 303 1
 1180              		.cfi_startproc
 1181              		@ args = 0, pretend = 0, frame = 0
 1182              		@ frame_needed = 1, uses_anonymous_args = 0
 1183 0000 00482DE9 		push	{fp, lr}
 1184              		.cfi_def_cfa_offset 8
 1185              		.cfi_offset 11, -8
 1186              		.cfi_offset 14, -4
 1187 0004 04B08DE2 		add	fp, sp, #4
 1188              		.cfi_def_cfa 11, 4
 304:Source/rme_benchmark.c ****     USR_DBG_S("\r\nbegin test ");
 1189              		.loc 1 304 5
 1190 0008 000000E3 		movw	r0, #:lower16:.LC13
 1191 000c 000040E3 		movt	r0, #:upper16:.LC13
 1192 0010 FEFFFFEB 		bl	USR_DBG_S
 305:Source/rme_benchmark.c ****     USR_DBG_H(0x111111);
 1193              		.loc 1 305 5
 1194 0014 110101E3 		movw	r0, #4369
 1195 0018 110040E3 		movt	r0, 17
 1196 001c FEFFFFEB 		bl	USR_DBG_H
 306:Source/rme_benchmark.c ****     RME_Same_Prc_Thd_Switch_Test();
 1197              		.loc 1 306 5
 1198 0020 FEFFFFEB 		bl	RME_Same_Prc_Thd_Switch_Test
 307:Source/rme_benchmark.c **** }
 1199              		.loc 1 307 1
 1200 0024 00F020E3 		nop
 1201 0028 0088BDE8 		pop	{fp, pc}
 1202              		.cfi_endproc
 1203              	.LFE18:
 1205              		.text
 1206              	.Letext0:
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 39


DEFINED SYMBOLS
                            *ABS*:00000000 rme_benchmark.c
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:25     .bss.RME_Stack:00000000 RME_Stack
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:22     .bss.RME_Stack:00000000 $d
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:32     .bss.Time:00000000 Time
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:29     .bss.Time:00000000 $d
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:39     .bss.RME_Bench_Buf:00000000 RME_Bench_Buf
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:36     .bss.RME_Bench_Buf:00000000 $d
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:42     .text.__USR_Putchar:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:47     .text.__USR_Putchar:00000000 __USR_Putchar
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:91     .text.USR_DBG_I:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:96     .text.USR_DBG_I:00000000 USR_DBG_I
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:246    .text.USR_DBG_H:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:251    .text.USR_DBG_H:00000000 USR_DBG_H
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:367    .text.USR_DBG_S:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:372    .text.USR_DBG_S:00000000 USR_DBG_S
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:434    .text.RME_Thd_Crt:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:439    .text.RME_Thd_Crt:00000000 RME_Thd_Crt
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:485    .text.RME_Thd_Exec_Set:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:490    .text.RME_Thd_Exec_Set:00000000 RME_Thd_Exec_Set
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:525    .text.RME_Thd_Time_Xfer:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:530    .text.RME_Thd_Time_Xfer:00000000 RME_Thd_Time_Xfer
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:563    .text.RME_Thd_Sched_Bind:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:568    .text.RME_Thd_Sched_Bind:00000000 RME_Thd_Sched_Bind
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:611    .text.RME_Thd_Swt:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:616    .text.RME_Thd_Swt:00000000 RME_Thd_Swt
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:648    .text.RME_Sig_Crt:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:653    .text.RME_Sig_Crt:00000000 RME_Sig_Crt
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:686    .text.RME_Sig_Del:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:691    .text.RME_Sig_Del:00000000 RME_Sig_Del
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:724    .text.RME_Sig_Snd:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:729    .text.RME_Sig_Snd:00000000 RME_Sig_Snd
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:760    .text.RME_Sig_Rcv:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:765    .text.RME_Sig_Rcv:00000000 RME_Sig_Rcv
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:797    .text._RME_Tsc_Init:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:802    .text._RME_Tsc_Init:00000000 _RME_Tsc_Init
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:827    .rodata:00000000 $d
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:828    .rodata:00000000 .LC0
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:831    .text.RME_Same_Prc_Thd_Switch_Test_Thd:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:836    .text.RME_Same_Prc_Thd_Switch_Test_Thd:00000000 RME_Same_Prc_Thd_Switch_Test_Thd
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:871    .rodata:0000001c .LC1
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:874    .rodata:00000030 .LC2
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:877    .rodata:00000054 .LC3
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:880    .rodata:00000068 .LC4
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:883    .rodata:00000088 .LC5
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:886    .rodata:000000b8 .LC6
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:889    .rodata:000000d8 .LC7
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:892    .rodata:00000104 .LC8
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:895    .rodata:00000130 .LC9
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:898    .rodata:00000134 .LC10
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:901    .rodata:00000160 .LC11
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:905    .rodata:00000198 .LC12
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:908    .text.RME_Same_Prc_Thd_Switch_Test:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:913    .text.RME_Same_Prc_Thd_Switch_Test:00000000 RME_Same_Prc_Thd_Switch_Test
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:1066   .text.RME_Same_Prc_Thd_Switch_Test:000001a8 $d
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:1072   .text.RME_Diff_Prc_Thd_Switch_Test_Thd:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:1077   .text.RME_Diff_Prc_Thd_Switch_Test_Thd:00000000 RME_Diff_Prc_Thd_Switch_Test_Thd
ARM GAS  C:\Users\even\AppData\Local\Temp\ccdbU5o4.s 			page 40


C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:1106   .text.RME_Diff_Prc_Thd_Switch_Test:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:1111   .text.RME_Diff_Prc_Thd_Switch_Test:00000000 RME_Diff_Prc_Thd_Switch_Test
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:1163   .text.RME_Diff_Prc_Thd_Switch_Test:00000070 $d
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:1169   .rodata:000001c4 .LC13
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:1172   .text.RME_Benchmark:00000000 $a
C:\Users\even\AppData\Local\Temp\ccdbU5o4.s:1177   .text.RME_Benchmark:00000000 RME_Benchmark
                           .group:00000000 wm4.0.3b9f63523dc4e8d86e863c7e7e762be7
                           .group:00000000 wm4.rme.h.11.105c42759f88404be372052d8d99e5e6
                           .group:00000000 wm4.benchmark.h.4.3811c48c84b319c58b1db55ea6a5257b

UNDEFINED SYMBOLS
__aeabi_idiv
__aeabi_idivmod
RME_Svc
RME_Thd_Stub
_RME_Stack_Init
